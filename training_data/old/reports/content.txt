Digital Forensics Analysis Report
Delivered to Alliance Defending Freedom

November 5, 2015

Prepared by Coalfire Systems, Inc.
Revision Summary
Date

Revision History

Comments

9/28/2015

1.0

Original final draft

11/5/2015

1.1

Corrected formatting issue on pages 10 and 11

Confidential Information
This Executive Summary of this report shall not be excerpted without prior written permission of Coalfire.

Version 1.1

1

Executive Summary
In September, 2015, CGS, the prime contractor on behalf of Alliance Defending Freedom, engaged Coalfire Systems, Inc.,
the sub-contractor (hereinafter “Coalfire”) to conduct a computer forensics analysis of certain raw video and audio data
files. Coalfire’s objectives for this project are to:
-

Forensically evaluate video and audio files provided by The Center for Medical Progress (“the Organization”)
through CGS (“raw” video and audio), and determine whether the raw video or audio content of the files have
been edited or otherwise altered;

-

Compare the raw video and audio to certain files posted to YouTube (“Full Footage” videos and a
“Supplemental” video) for the purpose of determining inconsistencies between the files.

The scope of Coalfire’s analysis did not cover or include:
-

Validation of those individuals depicted in the video or audio, who recorded the video and audio files, the
location where they were recorded, when they were recorded, or the purpose of the recordings;

-

Providing an opinion on the chain of custody prior to receipt of source materials by Coalfire;

-

Coalfire’s analysis was limited to only the source materials received from the Organization and did not include
interviews of participants in the videos or audio.

A flash drive containing recorded media was received via FedEx by Coalfire on September 17th, 2015, where it was
examined using industry-standard forensic tools and techniques. The flash drive contained (i) a total of ten (10) videos
with audio recorded on two (2) separate devices, and (ii) a total of eight (8) audio recordings made with two (2) audioonly devices.
Coalfire’s analysis of the recorded media files contained on the flash drive indicates that the video recordings are
authentic and show no evidence of manipulation or editing. This conclusion is supported by the consistency of the video
file date and time stamps, the video timecode, as well as the folder and file naming scheme. The uniformity between the
footage from the cameras from the two Investigators also support the evidence that the video recordings are authentic.
With regard to the “Full Footage” YouTube videos released by the Organization, edits made to these videos were applied
to eliminate non-pertinent footage, including “commuting,” “waiting,” “adjusting recording equipment,” “meals,” or
“restroom breaks,” lacking pertinent conversation. Any discrepancies in the chronology of the timecodes are consistent
with the intentional removal of this non-pertinent footage as described in this report.
Furthermore, four of the five raw video recordings, which also contained audio captured from the video recording
device, are accompanied by a raw audio recording captured from a separate audio-only recording device. The raw audioonly recordings last for the duration of their associated raw videos. These raw audio recordings support the
completeness and authenticity of the raw video recordings since they depict the same events within the same duration
as captured from the two separate video recorders.

Evidence Acquisition Processing Procedures
Coalfire employed industry standard tools and techniques throughout handling, processing, and analysis of the
evidence. A sealed FedEx Express envelope was received into Coalfire Labs via FedEx Overnight delivery on September
17, 2015 at 8:35 AM (MST). A Chain of Custody was established upon opening the package. The package contained one
USB flash drive sealed in a FedEx label pouch. Details about the enclosed media are included below.
Version 1.1

2

Device Make/Model

Device Serial Number

Description

Device Serial Number

Capacity

PNY “Turbo Plus” flash drive

2CE00713QB

USB flash drive (silver)
USB 3.0

UID: 1C233FA33C1C2A38

128 GB

Coalfire used a Logicube Falcon to create a raw DD image of the evidence onto a previously wiped hard drive. The
images were verified by their hash values. A working copy of the original image was created onto a previously wiped
hard drive. All subsequent analysis was performed on the working copy forensic image, not on the original media or the
original forensic image acquisition. The analysis was performed on a dedicated forensic workstation using AccessData’s
Forensic Toolkit (FTK) version 5.6.3.16, VLC Player version 2.2.1, Apple QuickTime version 7.7.8, and iZotope RX
Advanced.

Analysis
File and Folder Analysis
There were a total of 29 folders residing on the flash drive. Each of the folders shows a modified, accessed, and created
date of 2015-09-13 UTC with the modified and created time stamps between 2015-09-13 03:36:03 UTC and 2015-09-13
04:57:35 UTC. Copying a folder from a source drive to a destination drive results in the creation of a new modified and
created date and time stamp on the destination drive. The date and time stamp from the source drive directory does not
carry over to the directory created on the destination drive. This suggests that the date and time stamps for the folders
located on the flash drive are indicative of when the folders were copied from the original source drive to the flash drive.
The root consisted of 5 directories which are listed below with their creation time and date stamps.
Directory Name

Created

[root]\052215Dyer dinner

2015-09-13 03:36:47 UTC

[root]\072514DebNucatola

2015-09-13 03:36:03 UTC

[root]\PPGC040915

2015-09-13 03:36:32 UTC

[root]\PPPSGV020615

2015-09-13 03:36:15 UTC

[root]\PPRM040715

2015-09-13 03:36:26 UTC

Directories contained within the root of the flash drive
Within these directories were two subdirectories, each with the name of a male and a female. The male name will
hereinafter be referred to as “Investigator 1” and the female name as “Investigator 2.” Within each of these folders
were either a subdirectory named “MyRecord” or a folder named with a numeric date. Where there was a “MyRecord”
folder present, the “MyRecord” folder contained a subdirectory named by numeric date. The folders named by numeric
dates contained recorded video files corresponding to the numeric date of the folder. The five directories in the root
listed above delineate five separate dates of video recordings which is explained in further detail below.
The folders named with numeric dates contained video files. In total, there were 86 AVI video files on the flash drive.
The metadata for the AVI video files does not contain any metadata or unique file signatures to indicate the video
recording device that was used to create the video. Review of the video content reveals that the video files were
captured from two separate video recording devices which are separated into the Investigator 1 and Investigator 2
Version 1.1

3

directories. The numeric dates within the video file names are consistent throughout all other folder names in the path
to any given video file. Examples of the folder and file naming schemes are shown below.


[root]\072514DebNucatola\[Investigator 1]\MyRecord\20140725\FNND0569_20140725114841.AVI

The example above shows a folder naming structure containing the “MyRecord” subdirectory. In the example above, the
root directory name contains a numeric date of 7/25/2014, a subdirectory with a name containing the numeric date
7/25/2014, and containing a video file with a file name including the numeric date 7/25/2014. Another example of the
folder and file naming structure is shown below.


[root]\PPGC040915\[Investigator 2]\20150409\FNNI0773_20150409071900.AVI

In the example above, the root directory name contains the numeric date 4/9/2015, a subdirectory with a name
containing the numeric date 4/9/2015, and containing a video file with a file name including the numeric date 4/9/2015.
Contrary to folders, the last modified and created date and time stamps of a file is preserved when the parent folder it
resides in is copied from a source drive to a destination drive. Therefore, the last modified date and time stamps of the
video files contained on the flash drive were preserved from the original source files. The video files residing on the flash
drive show last modified and created time stamps between 2015-02-06 20:47:28 UTC to 2014-07-25 22:18:26 UTC.
Review of the video file modified date stamps shows that they are consistent with the numeric dates reflected in the
video file names as well as the folders in the path of those video files. Furthermore, the date stamps embedded within
the videos themselves are consistent with the date stamps of the folders in the video file path.
An example of the relationship between the video file name and file created date stamp is shown below.
Video File Name

Created

FNNI0773_20150206130219.AVI

2015-02-06 22:02:18 UTC

Video file name and created date stamp relationship
The AVI file names also contain a number representing the timecode that is embedded in the first frame of that video
file. An example of this is shown below.


[root]\PPGC040915\[Investigator 1]\FNND0569_20150409081515.AVI

In this example (on the following page), the video file named FNND0569_20150409081515.AVI shows a date of
4/9/2015 and a first frame timecode of 08:15:15. Below is a screenshot of the first frame (frame 000000) of the
20150409081515.AVI video.

Version 1.1

4

Timeframe count
embedded in video

Date and time
stamps
embedded in
video

First frame from video file [root]\PPGC040915\[Investigator 1]\FNND0569_20150409081515.AVI
There were some videos, however, where the first frame does show a timecode that is one second behind the time
shown in the video file name.
All of the AVI video files are 1011 MB in size or smaller. When the modified time stamps are in chronological order, it is
evident that a new video file is created once the preceding video file size reaches 1011 MB during continuous recording.
This is demonstrated by noting the final timecode embedded in the last frame of the video and comparing it to the
timecode in the first frame of the next video in sequence (the first frame timecode number is also contained in the video
file name). It is a common feature of video recording devices to capture continuous recording in numerous smaller
separate files to avoid issues with file systems that cannot accommodate large file sizes and to minimize data loss in the
case of file corruption as result of hardware failure (dead battery, malfunction, etc.). Review of the AVI files that were
smaller than 1011 MB appears to be the result of a manual stop performed on the recording device by the camera
operator.
Video File Recording Path

Continuous Video Recording Segments

052215Dyer dinner072514DebNucatola\[Investigator
1]\MyRecord\20140725

Continuous recording from 2014.07.25 11:48:41 to
2014.07.25 15:18:26 (frame 019233)

072514DebNucatola\[Investigator 2]\MyRecord\20130725

Continuous recording from 2013.07.25 11:41:24 to
2013.07.25 15:15:21 (frame 058664)

PPGC040915\[Investigator 1]\20150409

Continuous recording from 2015.04.09 07:18:22 to
2015.04.09 13:09:37 (frame 017915)
Continuous recording from 2015.04.09 13:16:58 to
2015.04.09 14:56:40 (frame 025881)

Version 1.1

5

PPGC040915\[Investigator 2]\20150409

Continuous recording from 2015.04.09 07:19:00 to
2015.04.09 13:20:01 (frame 062200)

PPPSGV020615\[Investigator 1]\20150206

Continuous recording from 2015.02.06 11:51:07 to
2015.02.06 13:34:49

PPPSGV020615\[Investigator 2]\20150206

Continuous recording from 2015.02.06 11:49:47 to
2015.02.06 13:36:05 (frame 060765)

PPRM040715\[Investigator 1]\MyRecord\20150407

Continuous recording from 2015.04.07 08:16:16 to
2015.04.07 13:04:06 (frame 006180)
Continuous recording from 2015.04.07 13:05:19 to
2015.04.07 14:31:28 (frame 001483)

PPRM040715\[Investigator 2]\MyRecord\20150407

Continuous recording from 2015.04.07 08:16:08 to
2015.04.07 14:12:40 (frame 054178)

Continuous video recording segments
Based on this evidence presented in this section, Coalfire concludes that the video files located on the flash drive are
accurate representations of the raw unedited footage captured by the original video camera with reliable and consistent
timecodes.

Video Content Analysis and Comparison
The video recordings created by both Investigator 1 and Investigator 2 depict many of the same scenes from two
different perspectives as captured by their individual cameras. The timecodes embedded in the video recordings are not
synced to each other. Coalfire determined the approximate offsets of the two video cameras for each day of recording.
Video Recording Top Parent Directory

Offset of Investigator 2 Camera to Investigator 1 Camera

052215Dyer dinner

Approximately +00:00:32

072514DebNucatola

Approximately -00:04:03

PPGC040915

Approximately -00:00:50

PPPSGV020615

Approximately -00:00:29

PPRM040715

Approximately -00:00:50
Video Camera Timecode Offset

By establishing the offset in timecode, Coalfire was able to compare events from each of the cameras as they happened
in real time. This was critical when comparing the raw footage videos contained on the flash drive to the Full Footage
videos released by the Center for Medical Progress on YouTube. The Full Footage CMP YouTube videos are listed below
and uploaded by the YouTube user “The Center for Medical Progress”.
Full Footage YouTube Video Name

YouTube Video URL

FULL FOOTAGE: Planned Parenthood VP Says Fetuses
May Come Out Intact, Agrees Payments...

https://www.youtube.com/watch?v=wV2U9unI1NM

Version 1.1

6

FULL FOOTAGE: Planned Parenthood Uses Partial-Birth
Abortions to Sell Baby Parts

https://www.youtube.com/watch?v=H4UjIM9B9KQ

FULL FOOTAGE: Intact Fetuses "Just a Matter of Line
Items" for Planned Parenthood TX Mega-Center

https://www.youtube.com/watch?v=MCiD9_ICt44

FULL FOOTAGE: Second Planned Parenthood Senior
Executive Haggles Over Baby Parts Prices

https://www.youtube.com/watch?v=vwAGsjoorvk

Full Footage CMP YouTube videos
After these “FULL FOOTAGE” videos were posted, an additional video was posted by the Organization on August 30,
2015 (the “Supplemental Full Footage Video”) that is of the same time duration as missing footage from the “FULL
FOOTAGE: Intact Fetuses ‘Just a Matter of Line Items’ for Planned Parenthood TX Mega-Center”.
Supplemental YouTube Video Name

YouTube Video URL

Part 2 Supplement TX FULL FOOTAGE: Intact Fetuses
"Just a Matter of Line Items" for PP

https://www.youtube.com/watch?v=wV2U9unI1NM

Supplemental Full Footage CMP YouTube video
Coalfire reviewed any and all inconsistencies in timecode apparent in the Full Footage videos for comparison to the raw
video footage corresponding to those videos. Notes were made upon review of the raw video content which described
the events that took place during the missing footage that was edited from the Full Footage videos. Events that were left
out of the Full Footage videos lacked pertinent conversation. The events depicted in the missing footage fell into five
common categories: commuting, waiting, adjusting recording equipment, meals, and restroom breaks. “Commuting”
footage consists of Investigator 1 and 2 driving in car to locations, or walking outside to locations outside or inside a
building. “Waiting” footage consists of Investigator 1 and 2 waiting to engage with primary Planned Parenthood subject,
or other personnel, usually in a lobby, office, or a restaurant table. “Adjusting recording equipment” footage consists of
times when Investigator 1 and 2 are manually setting camera or audio recording device equipment, adjusting the
equipment, or changing the batteries. “Meal” footage consists of Investigator 1 and 2 eating. “Restroom break” footage
consists of Investigator 1 or 2 going to the restroom primarily to relieve themselves.

FULL FOOTAGE: Intact Fetuses "Just a Matter of Line Items" for Planned Parenthood TX Mega-Center
Begins 2015.04.09 07:37:48 (034977)
Ends 2015.04.09 14:50:13 (014278)
Corresponding raw video recordings: PPGC040915
Investigator 1 begins video recording at 07:18:23 and ends video recording at 14:56:40
Investigator 2 beings video recordings at 07:19:00 and ends video recording at 13:20:01
Gap from beginning of raw footage to beginning of Full Footage at 07:37:48
Adjusting recording equipment – Commuting – Waiting

Version 1.1

7

Gap from 07:46:47 to 08:15:15
The 07:46:47 stop coincides with the end of the raw video file named FNND0569_20150409071822.AVI. The next file in
the sequence (FNND0569_20150409074648.AVI) starts at 07:46:48 (frame 000000) and ends at 08:15:09 (frame
051046). The next video file in sequence (FNND0569_20150409081515.AVI) starts at 08:15:15 (frame 000000). The
missing footage between in the Full Footage YouTube video between 7:46:47 and 8:15:15 matches the time duration of
the raw video file FNND0569_20150409074648.AVI.
Coalfire reviewed the content of the Supplemental Full Footage video against the raw video and audio and determined
that the supplemental video matches the timeframe, timecodes, and events depicted in the raw video file
FNND0569_20150409074648.AVI.

Gap from 08:44:26 to 08:48:39
Restroom break – Waiting
Gap from 12:58:43 to 13:50:18
Commuting – Restroom break - Waiting
Raw video footage after end of Full Footage video at 14:50:13
Commuting (example follows)

Investigator 1 PPGC040915 “commuting” footage video frame

Version 1.1

8

FULL FOOTAGE: Planned Parenthood VP Says Fetuses May Come Out Intact, Agrees Payments...
Being: 2015.04.07 09:10:10 (frame 045843)
End: 2015.04.07 14:17:27 (frame 027478)
Corresponding raw video recordings: PPRM040715
Investigator 1 begins video recording at 08:16:16 and ends video recording at 14:31:28
Investigator 2 begins video recordings at 08:16:08 and ends video recording at 14:12:40
Gap from beginning of raw footage to beginning of Full Footage at 09:10:10
Adjusting recording equipment – Commuting
Gap from 10:27:07 to 11:01:40
Meal – Waiting (example follows)

Investigator 1 PPRM040715 “meals” footage video frame

Gap from 11:24:49 to 11:27:37
Waiting
Gap from 11:36:47 to 11:39:25
Version 1.1

9

Waiting
Gap from 11:41:43 to 11:43:54
Waiting
Gap from 12:35:50 to 13:43:46
Restroom break – Adjusting recording equipment – Waiting
Gap from 11:45:46 to 12:21:55
Waiting
Raw video footage after end of Full Footage video at 14:17:27
Commuting – Waiting – Restroom break

FULL FOOTAGE: Planned Parenthood Uses Partial-Birth Abortions to Sell Baby Parts
Begin: 2014.07.25 12:17:07
End: 2014.07.25 15:02:33
Corresponding raw video recordings: 072514DebNucatola
Investigator 1 begins video recording at 11:48:41 and ends video recording at 15:18:26
Investigator 2 begins video recordings at 11:41:24 and ends video recording at 15:15:21
Timecode and year change from 2014.07.25 14:32:07 to 2013.07.25 14:28:04
Restroom break
In the Full Footage video, the video recording starts from Investigator 1. When Investigator 1 excuses himself for the
restroom, Investigator 2’s camera is used to follow the conversation at the table. The -00:04:03 offset from Investigator
2’s camera to Investigator 1’s camera explains the jump in time.
The raw video shows that Investigator 1’s camera shows the date stamp 2014.07.25 while Investigator 2’s camera shows
the date stamp 2013.07.25.

Version 1.1

10

Investigator 1 camera

Investigator 2 camera

The first frame from the footage on 7/25 shows that the date stamps show a one year difference
Since the raw video recordings both depict the same events in real time, the discrepancy in the date stamp year is
attributed to the two camera’s date and time settings not being synced to each other.
Gap from 14:38:06 to 14:41:08
Restroom break (example follows)

Investigator 1 072514DebNucatola “restroom break” footage video frame

Version 1.1

11

Raw video footage after end of Full Footage video (15:02:33)
Restroom break – Waiting – Commuting

FULL FOOTAGE: Second Planned Parenthood Senior Executive Haggles Over Baby Parts Prices
Begin: 2015.02.06 12:03:05
End: 2015.02.06 13:16:13
Corresponding raw video recordings: PPPSGV020615
Investigator 1 begins video recording at 11:51:07 and ends video recording at 13:34:49
Investigator 2 begins video recordings at 11:49:47 and ends video recording at 13:36:05
12:04:53 jumps back to 12:04:24
Restroom break (example follows)

Investigator 2 PPPSGV020615 “restroom break” footage video frame

Version 1.1

12

The Full Footage video starts on Investigator 1’s camera who is shown standing up from the table at 12:04:53. The video
then switches to Investigator 2’s camera at 12:04:24 which shows Investigator 1 walking from the table towards the
restroom. The Full Footage video uses Investigator 2’s camera for the remainder of the video. The time difference is
attributed to the -00:00:29 offset of Investigator 2’s camera to Investigator 1’s camera.
Raw video footage after end of Full Footage video (13:16:13)
Waiting – Commuting

Audio Content Analysis
With the exception of the “052215Dyer dinner” directory, each day of video recording was accompanied by MP3 audio
recordings within the Investigator 1 and Investigator 2 folders. This resulted in audio recordings from the point of view
of both Investigator 1 and Investigator 2 that are separate from the audio captured by the video recording device. Like
the video recordings, the audio files contained a numeric date in the file name. An example of one of the audio
recording file paths is shown below.
Audio File with Path

Created

[root]\PPPSGV020615\[Investigator 1]\150206_001.MP3

2015-02-06 21:52:37 UTC

This MP3 audio recording exhibits a file name containing the date 2/6/2015 which is consistent with the numeric dates
in the names of the other folders and files contained in the top level parent directory. The creation date of this file is
also consistent with the date contained in the names of the files and folders contained within the top parent directory.
The metadata embedded in the header of the hexadecimal data reveals that this audio recording was captured with a
Sony IC Recorder model ICD-UX-533. The metadata also reflects the date the recording was created which is consistent
with the file date stamp.

Sony flash voice
recorder model ICDUX533

Sony IC Recorder MP3

MP3 metadata audio
recording file date stamp

Metadata from [root]\PPPSGV020615\[Investigator 1]\150206_001.MP3 Audio File
The audio recordings were started shortly before or after their corresponding video recordings and span the duration of
the video recordings or more. Below is a chart with details about the audio recording.

Version 1.1

13

Audio File with Path

Created

Duration

[root]\072514DebNucatola\[Investigator 1]\140725_002.MP3

2014-07-25 18:47:00 UTC

03:28:28

[root]\072514DebNucatola\[Investigator 2]\140725_001.MP3

2014-07-25 18:40:41 UTC

03:31:59

[root]\PPPSGV020615\[Investigator 1]\150206_001.MP3

2015-02-06 21:52:37 UTC

01:47:20

[root]\PPPSGV020615\[Investigator 2]\150206_001.MP3

2015-02-06 20:47:28 UTC

01:46:08

[root]\PPRM040715\[Investigator 1]\150407_001.MP3

2015-04-07 15:16:50 UTC

06:16:22

[root]\PPRM040715\[Investigator 2]\150407_001.MP3

2015-04-07 15:20:16 UTC

06:16:49

[root]\PPGC040915\[Investigator 1]\150409_001.MP3

2015-04-09 14:20:20 UTC

0:7:39:57

[root]\PPGC040915\[Investigator 2]\150409_001.MP3

2015-04-09 14:21:53 UTC

07:41:43

MP3 Audio Recording Files
Much like the footage from the two separate cameras, Coalfire was able to time align the audio recordings to the video
footage to allow for review of any inconsistencies or anomalies in their content with both the video and audio
recordings from the two video cameras.

Version 1.1

14


Sample Forensics Report
Overview / Case Summary
On April 11, 2011, Paul Ceglia filed an Amended Complaint seeking a share of
Facebook. Mr. Ceglia based his claim on a purported contract between Mr. Ceglia and
Mark Zuckerberg (the “Work for Hire Document”). In addition, the Amended
Complaint included excerpts of purported emails between Mr. Ceglia and Mr.
Zuckerberg (the “Purported Emails”).

Objectives
This report is a summary of Stroz Friedberg’s findings regarding the authenticity of the
Work for Hire Document and the Purported Emails based on its analysis of the media
produced by Mr. Ceglia pursuant to data received as part of expedited discovery. This
report is not intended to detail each and every aspect of Stroz Friedberg’s work in this
engagement.

Evidence Analyzed
Pursuant to the Court Order, Stroz Friedberg collected digital media made available by
Mr. Ceglia. Stroz Friedberg inspected the data on the following media for analysis
according to the terms of the Court-ordered Protocol:
A Compaq Presario SR5413WM desktop computer with a 250 gigabyte hard drive.
An eMachines ET1161-05 desktop computer with a 160 gigabyte hard drive.
A Toshiba Satellite L305-55968 laptop computer with a 320 gigabyte hard drive.
A 200 gigabyte Maxtor Personal Storage 3200 external hard drive.
A 500 gigabyte Western Digital internal hard drive.
174 floppy disks.

https://www.cybersleuthlab.org

1.504.608.5766

info@cybersleuthlab.org

Using widely-accepted digital forensic techniques and procedures, digital forensic
personnel from Stroz Friedberg made bit-for-bit, verified forensic copies or images of:
the hard drive within the Compaq Presario desktop computer; the hard drive within the
eMachines desktop computer; the hard drive within the Toshiba Satellite laptop
computer; the Maxtor external hard drive; the Seagate Hard Drive; and 173 of the 174
floppy disks.
The digital forensic copying process captured the entire contents of each piece of
media, including the active user-accessible files, the deleted files, and the unallocated
space, which may contain deleted content. Because the forensic image created by
Plaintiff’s Expert is a forensic image file, Stroz Friedberg used a forensically-sound copy
method to copy the forensic image file on that drive to preservation media.

Investigation Steps
Stroz Friedberg conducted its analysis of the Ceglia media pursuant to the Protocol
issued by the Court. Stroz Friedberg searched and analyzed the Ceglia Media “to
identify only documents, data, fragments, and artifacts that reasonably appear[ed] to
be related to the authenticity of the [Work for Hire Document] attached to the
Amended Complaint and the [P]urported [E]mails described in the Amended
Complaint.”. The documents, data, fragments, and artifacts found by Stroz Friedberg
that reasonably appeared to be related to the authenticity of the Work for Hire
Document or the Purported Emails first were produced to Mr. Ceglia’s attorneys for a
privilege review. The material was turned over to attorneys from Gibson Dunn only if
no privilege objection was raised, an asserted privilege objection was withdrawn by Mr.
Ceglia or his attorneys, or an assertion of privilege was overruled by the Court. Stroz
Friedberg has followed the terms of the Protocol for all data found on the Ceglia
Media and any other data subject to the Protocol during its analysis, including the
procedures for privilege review and production set forth above and the maintenance of
a search log.

1.504.608.5766

info@ cybersleuthlab.org

https://www.cybersleuthlab.org

During this analysis, Stroz Friedberg employed a methodology tailored to the particular
facts of this case. Stroz Friedberg’s methodology included: (1) conducting keyword and
other searches of the digital forensic copies of the Ceglia Media and other data,
including webmail accounts, to identify responsive documents or fragments of
documents; (2) manually reviewing the documents containing keyword hits, certain
unsearchable file types, such as image files with no text, and other documents to
determine whether they were relevant to the authenticity of the Work for Hire
Document or the Purported Emails; and (3) reviewing the digital forensic copies of the
Ceglia Media for digital forensic artifacts relevant to the authenticity of the Work for
Hire Document or the Purported Emails.

Findings
No exact copies of the Work for Hire Document were found on the Ceglia Media,
which comprised hundreds of pieces of media - including computers, hard drives and
floppy disks. Stroz Friedberg used a methodology that would have identified any
copies of the Work for Hire Document on the Ceglia Media if they had been present.
Instead of the purported Work for Hire Document, Stroz Friedberg found on the Ceglia
Media seven unsigned versions of the Work for Hire Document that are very similar but
not identical to the purported Work for Hire Document. All seven of those electronic
documents contain metadata anomalies indicative of backdating and document
manipulation.
Mr. Ceglia’s Amended Complaint purports to quote from or otherwise reference 22
Purported Emails between Mr. Ceglia and Mr. Zuckerberg. During the litigation, Mr.
Ceglia acknowledged that he did not keep the Purported Emails referenced in the
Amended Complaint in their original native form, that is to say, as individual files in
message format. Rather, he claimed to have copied-and-pasted the text of the
Purported Emails into Microsoft Word documents saved to floppy disks in order to
maintain copies of these messages.

1.504.608.5766

info@ cybersleuthlab.org

https://www.cybersleuthlab.org

Stroz Friedberg found substantial evidence that all three of the Word documents
containing the purported emails are backdated. The effect of backdating is to obscure
the true date and time at which computer activity, such as the creation or modification
of documents, occurred. Backdating can be accomplished by setting the system clock
on a computer hard drive to an earlier date, such that activity that occurs on the hard
drive while the computer is in a backdated state will appear to have occurred at that
earlier time.
Moreover, the last printed date of the document is February 15, 2011, while the
document’s last modified date is April 25, 2003. As discussed above, absent
backdating or manipulation of the system clock, it is not possible for a file’s last printed
date to post-date its last modification date. Therefore, this document was fabricated on
or after February 15, 2011. This date is years after the Work for Hire Document was
allegedly signed and months after Mr. Ceglia filed this lawsuit.

Conclusion
Stroz Friedberg found direct and compelling digital forensic evidence that the
documents relied upon by Mr. Ceglia to support his claim are forged. Stroz Friedberg
also found what it believes to be the authentic contract between Mr. Ceglia and Mr.
Zuckerberg. That contract contains no references to Facebook. As described more fully
in this report, Stroz Friedberg made the following findings bearing on the authenticity
of the Work for Hire Document and the Purported Emails:
Stroz Friedberg did not find any exact copies of the Work for Hire Document on the
hundreds of pieces of media produced by Mr. Ceglia, including three computers, three
hard drives, 174 floppy disks, and 1,087 CDs (hereinafter, the “Ceglia Media”).
Stroz Friedberg did find a signed copy of an April 28, 2003 contract between Mr.
Ceglia and Mr. Zuckerberg, though it concerns only Mr. Zuckerberg’s work on the
StreetFax project and includes no references to Facebook.

1.504.608.5766

info@ cybersleuthlab.org

https://www.cybersleuthlab.org

Stroz Friedberg identified seven unsigned electronic documents on the Ceglia Media
that are variants of the Work for Hire Document. All of these electronic documents
were backdated to appear as if they were created at earlier dates. They appear to be
part of an effort to create a fraudulent contract.
Stroz Friedberg did identify the Microsoft Word documents into which Mr. Ceglia
claims to have copied-and-pasted the text of the Purported Emails. All of these Word
documents were backdated to appear as if they were created at earlier dates.
The Purported Emails themselves, which Mr. Ceglia has proffered as authentic
communications with Mr. Zuckerberg, are fabricated. Many of the Purported Emails
reflect the wrong time zone. For example, all of the Purported Emails purportedly sent
from October 26, 2003 to April 4, 2004 contain the “-0400” time zone stamp that
reflects Eastern Daylight Time. However, Eastern Daylight Time was not in effect during
this time. There is no place in the Continental United States from which Mr. Ceglia
could have sent these Purported Emails with an accurate “-0400” time zone stamp.
The Purported Emails have formatting differences in the email headers that are
inconsistent with Mr. Ceglia’s explanation that he copied-and-pasted the emails into
Word documents. These formatting differences indicate that the Purported Emails were
typed or edited manually and were not solely the result of a copy-and-paste operation.
There is no digital forensic evidence on the Ceglia Media supporting a conclusion that
the Work for Hire Document or the Purported Emails are authentic documents dating
from 2003 and 2004. To the contrary, the digital forensic evidence strongly indicates
that these documents were fabricated by Mr. Ceglia at a later date.

1.504.608.5766

info@ cybersleuthlab.org

https://www.cybersleuthlab.org

Exhibits:

1.504.608.5766

info@ cybersleuthlab.org

https://www.cybersleuthlab.org


OFFICIAL USE ONLY

OFFICIAL USE ONLY

[Agency] Case #:

     



DIGITAL EVIDENCE FORENSIC REPORT



Your Logo Here





Your address here





CASE INFORMATION:

Agency Case #:

     

Originating Agency Case #:

     



[removed] #:

     

[removed] #:

     

Remedy#:

     





Distribution:

 [removed]    [removed]    [removed]    IT    [removed]    Internal Audit    Emp. Relations    CI     Other:       



Date/Time Report Completed:

     

Date/Time Incident Occurred:

     



Type of Report:





INVOLVED:

  Involved       

  Witness  

  Complainant  

  Mentioned

Name:                         

Last:  

     

First:

              

Title:

     

Mailstop:

     

Email:

     

Cell Phone:

     

Work Phone:

     

Employee #:

     



  Involved       

  Witness  

  Complainant  

  Mentioned

Name:                         

Last:  

     

First:

              

Title:

     

Mailstop:

     

Email:

     

Cell Phone:

     

Work Phone:

     

Employee #:

     



  Involved       

  Witness  

  Complainant  

  Mentioned

Name:                         

Last:  

     

First:

              

Title:

     

Mailstop:

     

Email:

     

Cell Phone:

     

Work Phone:

     

Employee #:

     





























CLASSIFICATION LEVEL HERE

May be exempt from public release under the Freedom of Information Act (5 U.S.C. 552) exemption number and category: 7, Law Enforcement



Department of Name of Agency review required before public release

Name/Org: Your name/org	Date: 

Guidance (if applicable): 

CLASSIFICATION LEVEL HERE

May be exempt from public release under the Freedom of Information Act (5 U.S.C. 552) exemption number and category: 7, Law Enforcement



Department of Name of Agency review required before public release

Name/Org: Your name/org	Date: 

Guidance (if applicable): 















SUMMARY:





EVIDENCE SUBMITTED:



Item #







		





SOFTWARE UTILIZED



All software utilized in this examination is fully licensed and registered to [Agency Name] or its agents.  All software and forensic hardware has been validated pursuant to [Agency Name] policies and procedures.





FORENSIC EXAMINATION OF EVIDENCE

ITEM #1



Item #1 – Can be described as



[insert photo here]

[insert photo here]

[insert photo here]

[insert photo here]



HASH OF ORIGINAL EVIDENCE



The original media was connected to a forensic hardware write blocker (asset tag #) and the write blocker connected to a forensic computer (asset tag #).  Prior to doing anything with the original media, the media was hashed to obtain a baseline hash value.  This allows the hash value of the original media to later be compared to the hash value of the forensic image created of the original media.  By comparing the hash values of the original media and that of the forensic image, the forensic image can be authenticated as an exact duplicate copy of the original evidence.



The hash values obtained from the original evidence were as follows:





  MD5: 	       

  SHA1: 	     

  Other: 	     





FORENSIC IMAGING



After obtaining the hash value(s) of the original media, a forensic image was created.  The forensic image was placed on a:





  Government owned, forensically wiped hard drive

  Government owned, forensically wiped Storage Area Network (SAN)





The forensic imaging software utilized in this process creates an imaging report, detailing the hash value(s) of the newly created forensic image.  The hash value(s) of the forensic image was compared to the original hash value obtained prior to imaging the device.  The hash value(s) of the forensic image:





  Matched exactly the hash value(s) of the original media.

  Did not match the original hash value(s) of the media.  If checked, provide explanation below.







VIRUS AND MALWARE



The original media was scanned for malware.  Prior to the scan, all malware definitions were updated.  The results were:





  No malware detected.

  Malware detected.  If checked, identify and report on malware located below.





DRIVE GEOMETRY





BIOS EXAMINATION



Once the hard drive was removed, the computer was turned on and the BIOS (Basic Input/Output System) checked.  The following was found:





  The date and time were accurate.

  The date was accurate, but the time was inaccurate.  List time offset from correct time:      

 The time was accurate, but the date was inaccurate.  List date offset from correct date:     

  Forensic computer was adjusted to compensate for any time differences.



What was used as a time reference:





  Cellular phone set by network.

  Other:       



FORENSIC EXAMINATION OF FILES







DISPOSITION



EVIDENCE DISPOSITION





FORENSIC EXAMINER’S CONCLUSION





DISPOSITION





ATTACHMENTS





APPROVALS





Report Author Digital Signature:				Report Approver Digital Signature:





             

[insert scanned signature here]

Insert Name

Insert Title

Page 2 of 4

OFFICIAL USE ONLY



Page 1 of 1

OFFICIAL USE ONLY
Forensic Notebook (w/ edits)
for
Det. BROWN

2017-07-09 @ 17:54 (UTC -8)
to
2017-07-09 @ 18:08 (UTC -8)

This document contains the following sections:
1 Forensic Notebook (w/ edits) Summary
Notebook details including the number of notes and attachments contained within this Forensic
Notebook (w/ edits).
2 Validating the Authenticity of this Document (if required)
Web Address URL to determine if this Forensic Notebook (w/ edits) is current and valid.
3 Digital Signature
Logo indicating that this document has been Digitally Signed and Timestamped. Verifiable within
Adobe Reader, Adobe Acrobat or by utilizing the Validation URL.
4 Exact contents of each Note entered by Det. BROWN
Each note entered by Det. BROWN has been Digitally Signed and Timestamped. An exact copy of
all notes and attachments entered by Det. BROWN is included within this Forensic Notebook (w/
edits).
NOTE:
Older versions of a Forensic Note may exist as a result of changes made by the owner of the
note. If the current Forensic Note has older existing versions, the NoteID and Timestamp
information of the older Forensic Note will be provided. If required, the older Forensic Notes are
available within the ZIP archive package downloaded with this Forensic Notebook.

Potential Relevant Information
Additional notes may have been created since this Forensic Notebook (w/ edits) PDF was
generated on 2017-10-11 @ 09:12:50 (UTC -8) . The Validation URL listed on the next page will
indicate if additional notes exist.

TwiceSafe Software Solutions Inc.

Contemporaneous Notebook (edits allowed) - Ver 1.2

Notebook Overview

FORENSIC NOTEBOOK (W/ EDITS) INFORMATION
Summary as of 2017-10-11 @ 09:12 (UTC -8)
Owner:

Det. BROWN

Notebook Type:
Notebook ID:
Number of Notes:
First Note Created:
Last Note Created:
Number of Attachments:
Number of Edited Notes:

Contemporaneous Notebook (edits allowed)
adad3fd0-180f-4a7b-9c58-62d04bd2688d
7
2017-07-09 @ 18:03 (UTC -8)
2017-07-09 @ 20:58 (UTC -8)
1
1

Notebook Created:
Forensic Notebook (w/ edits) PDF
Generated:

2017-07-09 @ 07:45 (UTC -8)
2017-10-11 @ 09:12 (UTC -8)

Forensic Notes - Summary Information Pages
The Notes on the following Forensic Note Summary pages are an exact copy of the original content entered by the owner
of this notebook. If required, each Forensic Note Summary can be compared to the original Forensic Note digitally signed
and timestamped at the time of creation.

Validating the Authenticity of this Document (if required)
If the authenticity of this Forensic Notebook (w/ edits) is in question, it can be validated by going to the following URL:
https://www.ForensicNotes.com/Validate

System Generated Files
The SHA-512 Hash value of this saved PDF document will be sent to a Trusted Timestamp Authority (TSA) which will generate
an RFC 3161 Timestamp. The Timestamp will be returned within a .p7s file which contains this PDF’s SHA-512 value, RFC
3161 Timestamp and an x.509 Public Key Certificate.

Digital Signature

TwiceSafe Software Solutions Inc.

Contemporaneous Notebook (edits allowed) - Ver 1.2

Notebook Overview

NOTES
Sunday - July 09, 2017 (2017-07-09)

17:54 (UTC -8)
NoteID:

3038a1ed-f961-4629-98ac-8f55ece4f5b2 (1)

Older versions of this Forensic Note exist:
NoteID: ee861d83-1e07-46b8-a52a-e9002e97eebf

Timestamp: 2017-07-09 @ 20:58 (UTC -8)
Timestamp: 2017-07-09 @ 18:03 (UTC -8)

Exhibit #1, began examination of device in the digital forensic faraday room. Exhibit was a white iPhone 6 stored in a sealed
RF shielded can.
Reviewed Search Warrant and Exhibit Request form.
Open the sealed RF can and removed the exhibit and began to take exhibit photos.

Noted the Model # and IMEI as shown on the back of device.
Removed SIM Card and noted ICCID.
Powered on exhibit #1, battery had low charge. Connected device to power source to charge battery.

18:03 (UTC -8)
NoteID:

be38b538-f1b8-418d-a8b1-7a28a3fdd93f (2)

Timestamp: 2017-07-09 @ 18:04 (UTC -8)

Checked exhibit #1, and noted device was fully charged.
Physical extraction not supported on this device.
Began logical extraction on phone using ABC Forensic Software (Ver. 1.2.3).

18:04 (UTC -8)
NoteID:

82ddca75-86d0-48e7-8d3a-9c5ca1038ce4 (3)

Timestamp: 2017-07-09 @ 18:05 (UTC -8)

Began verification of data extraction by reviewing applications on the device and comparing it to extraction.

18:04 (UTC -8)
NoteID:

f5e9e578-03ae-42b6-9ef0-2d1c94fef5df (4)

Timestamp: 2017-07-09 @ 18:07 (UTC -8)

View conversation on device with “Rob the Robber” (1-555-555-1234), verified a message marked as deleted within
extraction was not visible in conversation on the device.

TwiceSafe Software Solutions Inc.

Contemporaneous Notebook (edits allowed) - Ver 1.2

Notebook Overview

18:05 (UTC -8)
NoteID:

70835fa0-1479-4198-b16c-3a6096a974ba (5)

Timestamp: 2017-07-09 @ 18:08 (UTC -8)

All applications that were of relevance appeared to be successfully extracted.

18:05 (UTC -8)
NoteID:

2515f700-df0b-4ccd-8570-88a1a2c474ed (6)

Timestamp: 2017-07-09 @ 18:08 (UTC -8)

Provided a preliminary report to the lead investigator, Det. JONES.
Included Call Logs, Instant Messages Images and Videos
Advised Det. JONES to identify any information of relevance.

18:08 (UTC -8)
NoteID:

66aa333b-9d4d-4c79-aecb-997df1a07076 (7)

Timestamp: 2017-07-09 @ 18:11 (UTC -8)

Attachments:
1) 17-00003 - Ex#1 - Email from Det JONES.pdf
On 2017-07-09, I, received an email response from Det. JONES who identified relevant info.
He identified Call Logs and Instant Messages from 2017-01-01 to 2017-01-05.
Also identified 10 images and 2 videos of relevance.
Plan to prepare a FINAL REPORT highlighting the above identified information.

TwiceSafe Software Solutions Inc.

Contemporaneous Notebook (edits allowed) - Ver 1.2

Notebook Overview


Global Information Assurance Certification Paper

Copyright SANS Institute
Author Retains Full Rights
This paper is taken from the GIAC directory of certified professionals. Reposting is not permited without express written permission.

Interested in learning more?

Check out the list of upcoming events offering
"Advanced Incident Response, Threat Hunting, and Digital Forensics (Forensics 508
at http://www.giac.org/registration/gcfa

05
,A

ut

ho

rr

eta

ins

fu
ll r

igh
ts.

Table of Contents..............................................................................................................................1
Stephen_Armstrong_GCFA.doc........................................................................................................2

©

SA

NS

In

sti

tu

te

20

Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

© SANS Institute 2005

Author retains full rights

fu
ll r

igh
ts.

Submitted on 14 January 2005 for the GIAC Certification program
for Computer Forensics
(Track 8 Assignment Version 1.5)

ins

by

rr

eta

Stephen Armstrong

ut

ho

The two parts selected for completion:

05
,A

In scenario analysis of the Floppy Disk image
(obtained from GIAC Web site).
&

tu

te

20

Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

©

SA

NS

In

sti

The Analysis of a Hard Disk recovered from an abandoned
Computer.

1 of 57
© SANS Institute 2005

Author retains full rights

Table of Contents
Abstract

3

Report on the Forensic Analysis of a recovered Floppy Disk

fu
ll r

igh
ts.

Background
The Forensic Workstation
Backing up the disk
AntiVirus Scan of the disk image
Creation of the Working Copy
The Initial Analysis
Working with Autopsy
Creating a File Activity Timeline

Detailed Analysis

ho

What Happened (Investigators Opinion)

rr

eta

ins

Camouflage
Passwords
File Timings Explained

Post Incident Activities

4
4
5
6
6
7
7
8

13
13
14
16

17
18

05
,A

ut

The Software found and possibly used by Leszczynski

4

19

IT Forensic Analysis of an abandoned computer and its Hard Disk

23

20

sti

tu

te

20

Keyposition
fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46
Legal

SA

NS

In

Background
Legal Implications of using the abandoned computer
Basic Analysis
Investigation Objectives

32

©

Detailed Analysis

23
26
27
32

Why did the system fail?
AntiVirus, Trojan and Malware Scans
System ownership and why this happened
Legal issues
Summary of events and supposition by the investigator

Conclusions and points learnt

36
38
46
50
51

52

2 of 57
© SANS Institute 2005

Author retains full rights

Table of Items (tables, command outputs and screen captures)

54

References

55

Abstract
This document is submitted as the practical part of the GCIA Certified Forensic
Analyst program (GCFA)1.

fu
ll r

igh
ts.

This practical is in two parts, the first of which required an image of a floppy disk to
be analysed and a report submitted based upon the contents. During this part of
the practical, the investigator discovered traces of a steganographic program
(Camouflage.exe). The conclusion being that the owner and holder of the disk had
attempted to export company data via this hidden means.

rr

eta

ins

The second part of the practical required the analysis of a system that had been
compromised. Due to difficulties obtaining such a system, approval was given for
the author to analyse an abandoned pc bought from a refuse disposal facility (thus
the investigator had no knowledge as to the contents of the drive, its purpose or the
intent of the user).

©

SA

NS

In

sti

tu

te

20

05
,A

ut

ho

During the second phase of this practical the contents of the abandoned system’s
hard drive was examined to glean the user’s role, their style and skill in operating
the system. An examination of the drive for illegal or inappropriate data/content was
conducted and a comment made as to the possible breaches of UK or International
laws. Finally, the drive’s owner is identified from the contents of the hard disk, and
their recent activities and actions traced.
Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46
The conclusion draws the problems and complexities of the whole process together
and identifies how a lack of user knowledge resulted in a system being brought to
its knees with Spyware before, in an effort to protect it, the user rendered it
inoperable by the installed of defensive software.

3 of 57
© SANS Institute 2005

Author retains full rights

Report on the Forensic Analysis of a recovered Floppy Disk
Background

igh
ts.

On 27 April 2004, the forensic investigator was tasked by Mr Keen to conduct an
analysis of a floppy disk recovered from a Robert John Leszczynski, Jr., who was
employed by Ballard Industries, as the lead process control engineer for the project
to design a new fuel cell battery.

fu
ll r

The floppy disk was recovered by a security guard who seized it from the above RJ
Leszczynski at 1645 on 24 April 2004. The disk had been in Leszczynski’s
briefcase, but this was in breach of the Company Security Policy and therefore the
guard impounded the disk, forwarding it to Mr Keen to Security Administrator.

eta

ins

The Security Administrator was mindful for the ongoing investigation into customer
drift and information leakage and request a full analysis of the disks contents.

ho

rr

The only item of evidence submitted or analysis was a single Floppy Disk. The disk
received was identified and described as:
Item 1 – Identification details for recovered Floppy Disk

tu

te

The Forensic Workstation

20

05
,A

ut

Description
3.5 inch TDK floppy disk
Serial Number of item:
Tag# fl-260404-RJL1
MD5 Hash of Disk
d7641eb4da871d980adbe4d371eda2ad
Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

In

sti

The forensic workstation image was re-ghosted to the laptop and all respective
security and reliability patches applied. The workstation used was a Dell [Dell]
Inspiron 5100 with removable hard disk caddies containing:

SA

NS

1 x 30 gb Linux Fedora Core 2 OS2, complete (ie the everything option
checked during the installation process) and Autopsy3 v1.7 and The Sleuth
Kit4 v 1.72 installed.

©

1 x 30 gb Windows XP Pro5 (complete build) with Norton AntiVirus 20036
(fully patched and up-to-date), Adobe PDF Reader.
All products were updated remotely via removable media and therefore, had never
been connected to the internet; thus they can be judged to be forensically and
operationally sound in that they will represent accurately all data they process and
display. The image of the laptop has been retained for future use and reference
should it be required.
Autopsy (v1.70) and The Sleuth Kit were then loaded to perform various analyses on
4 of 57
© SANS Institute 2005

Author retains full rights

the image and files within. Due to some compiling issues with The Sleuth Kit v1.72
(TSK), the newer version (v2.03) of Autopsy could not be loaded onto the Forensics
System (lib failure with Fedora Core 2 (FC2)). TSK is a collection of command line
tools that have been adapted and modified from their original release in the form of
‘The Coroner’s Toolkit7 (TCT). Autopsy is a graphical front end to TSK that uses perl
to interprets the user’s actions and builds the TSK commands in the background.
The user interface is via a standard web browser but output is graphical with logs,
recovered files, md5 hashes, timeline output etc being stored in a user definable
mounted file structure. All these tools are available from <www.sleuthkit.org>.

ho

rr

eta

ins

fu
ll r

igh
ts.

These programs (Autopsy and The Sleuth Kit) are reputable open source Forensics
tools, that themselves have both been subjected to Forensics Analysis to ensure
they do not alter or corrupt data being analysed. The output from the Autopsy is in
the form of test files that are stored in a folder designated by the initial investigator.
These test files are created and md5 hashes performed on each as they are written
to the HDD. The md5 hash is stored with the output and then the output is
displayed for the investigator. All output listed in this report will be using the text
saved by Autopsy (unless otherwise stated). Screen shots included will be of the
web interface used by the investigator. Additionally, were command line interface
(CLI) instructions, programs or commands are used their output will be reproduced
in this report with information on the platform and OS the command was issued
from or to.

ut

Backing up the disk

NS

In

sti

tu

te

20

05
,A

A copy of the recovered floppy disk image was made and an MD5 Sum performed
on the image. This MD5 sum was compared with the original and found to be an
exact
match,
indicating
the
image
was
a bit
for bit
reproduction
of A169
the original
Key
fingerprint
= AF19
FA27
2F94
998D
FDB5
DE3D
F8B5 06E4
4E46 disk.
The original disk was then placed in an envelope marked with the details above and
the md5 sum of the disk at the time of sealing. The envelope was then sealed and
all joints signed by the investigator and the Security Administrator, with all signed
parts then covered with anti-tamper tape. The disk was then placed in the fire proof
a humidity controlled safe. The investigator has had no access to the disk,
envelope or safe since they were secured. The working image of the disk was
labelled:

SA

Item 2 – Label details for the Master Working Disk (image)

©

Description
File name of image
MD5 Hash of image v1_5.gz

Image of floppy disk tagged Tag# fl-260404-RJL1
V1_5.gz
D7641eb4da871d980adbe4d371eda2ad

The file (Linux), md5 (Linux) and fsum8 (Windows) commands were run on the
image to confirm it had retained its floppy disk properties despite being imaged.
Item 3 – file (Linux) Command Output of v1_5.gz

Command

file v1_5.gz
5 of 57

© SANS Institute 2005

Author retains full rights

/root/v1_5.gz: x86 boot sector, code offset 0x3c,
OEM-ID " mkdosfs", root entries 224, sectors 2872
(volumes <=32 MB) , sectors/FAT 9, serial number
0x408bed14, label: "RJL
", FAT (12 bit)

Output

Item 4 – md5 (Linux) Command Output of v1_5.gz

Command
Output

Md5 v1_5.gz
d7641eb4da871d980adbe4d371eda2ad
/root/v1_5.gz

igh
ts.

To prove the md5 software was correct and functioning correctly the same file was
hashed on the windows system.
Item 5 – fsum (Windows) Command Output of v1_5.gz

fu
ll r

fsum –md5 v1_5.gz
; SlavaSoft Optimizing Checksum Utility fsum 2.0
<www.slavasoft.com>
;
; Generated on 11/09/04 at 21:09:08
;
d7641eb4da871d980adbe4d371eda2ad *v1_5.gz

rr

eta

ins

Command
Output

ut

ho

AntiVirus Scan of the disk image

20

05
,A

The disk was subject to an AntiVirus Scan using Norton AV, which was updated
moments before the scan being run. It was therefore considered that the image did
not contain any viruses known at the time of the scan (that were detectable).
Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

©

SA

NS

In

sti

tu

te

Item 6 – Screenshot of Norton AV (Windows) Completing Scan of v1_5.gz

Creation of the Working Copy
A copy was then taken of the image file and the “Master Working” image placed in
a separate folder. All activities were conducted on the “Working Copy”. If the
working copy had become corrupt at any point new version could be made form the
Master Working. At every stage MD5 Sums were taken and compared to the sum
6 of 57
© SANS Institute 2005

Author retains full rights

on the original label. All hashes for the Master Working, Working Copy and the
documented floppy disk, were exactly the same.

The Initial Analysis

igh
ts.

The disk image was made read only in the Linux OS [chmod 444 v1_5.gz] and
thus any activity and investigation conducted by the investigator could not have
affected the disk image. As a precaution once the investigation was complete a
final md5 hash was conducted and it confirmed that the image had not been altered
during the analysis.

fu
ll r

Working with Autopsy
Viewing the file structure and disk contents

ho

rr

eta

ins

Having started Autopsy, the image was mounted and the file contents were
checked and listed. The screenshot below shows the file index of the floppy disk.
Of note are the two deleted files on the disk namely: “_ndex.htm” and
“_AMSHELL.DLL”. Md5 hashes were taken of the live files and this was saved as
“md5_of_std_files_on_RJL.txt” (listed below).

05
,A

ut

Item 7 – Initial file browsing with Autopsy

©

SA

NS

In

sti

tu

te

20

Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

Item 8 – Autopsy output of visible file on target disk

7 of 57
© SANS Institute 2005

Author retains full rights

Comman
d
Output

Autopsy output of md5 request on visible files
MD5 Values for files in v1_5.gz
99c5dec518b142bd945e8d7d2fad2004
e0c43ef38884662f5f27d93098e1c607
b9387272b11aea86b60a487fbdc1b336
ac34c6177ebdcaf4adc41f0e181be1bc
5b38d1ac1f94285db2d2246d28fd07e8
f785ba1d99888e68f45dabeddb0b4541

Information_Sensitivity_Policy.doc (INFORM~1.DOC)
Internal_Lab_Security_Policy1.doc (INTERN~1.DOC)
Internal_Lab_Security_Policy.doc (INTERN~2.DOC)
Password_Policy.doc (PASSWO~1.DOC)
Remote_Access_Policy.doc (REMOTE~1.DOC)
Acceptable_Encryption_Policy.doc (ACCEPT~1.DOC)

Creating a File Activity Timeline

ins

fu
ll r

igh
ts.

Next a file timeline was created from all Allocated and Unallocated space on the
drive including the Unallocated Meta Data structures. This would show the order in
which files were created, modified and deleted. The file was created by Autopsy
and as the ‘output/body’ file was created an md5 hash of the file was also written to
the working folder (/forensics/floppy/FloppyDisk/). The final step for this
item was to create the time-line file from the body with a start and end point. As
Floppy disk contained small amounts of data a complete timeline was requested
and this was saved as ‘output/total-timeline’.

05
,A

ut

ho

rr

eta

The timeline would be later analysed and referred to as a key reference document,
indicating file activity and user actions. As the timeline related to a floppy disk the
activity recorded would primarily be that of the user as systems are rarely able to
page or record system activity to the media (limited volume size, slow read and
write speed coupled with a lack of system pre-notification as to its removal)

©

SA

NS

In

sti

tu

te

20

Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

8 of 57
© SANS Institute 2005

Author retains full rights

fu
ll r
igh
t
Apr
Apr
Apr
Apr
Apr

23
23
23
23
26

2004
2004
2004
2004
2004

11:54:32
11:55:26
14:10:50
14:11:10
00:00:00

ns

tit

ut

e2

Key fingerprint = AF19

ho

Fri
Fri
Fri
Fri
Mon

ut

Fri Apr 23 2004 10:53:56

5,
A

Thu Apr 22 2004 16:31:06

36864 m..
-rwxrwxrwx 0
36864 m.. -/-rwxrwxrwx 0
33423 m.. -/-rwxrwxrwx 0
32256 m.. -/-rwxrwxrwx 0
727 m.. -/-rwxrwxrwx 0
727 m..
-rwxrwxrwx 0
215895 m.. -/-rwxrwxrwx 0
307935 m.. -/-rwxrwxrwx 0
22528 m.. -/-rwxrwxrwx 0
42496 m.. -/-rwxrwxrwx 0
215895 .a. -/-rwxrwxrwx 0
727 .a. -/-rwxrwxrwx 0
FA27
2F94
FDB5 DE3D
307935
.a.998D
-/-rwxrwxrwx
0
33423 .a. -/-rwxrwxrwx 0
42496 .a. -/-rwxrwxrwx 0
36864 .a.
-rwxrwxrwx 0
32256 .a. -/-rwxrwxrwx 0
22528 .a. -/-rwxrwxrwx 0
727 .a.
-rwxrwxrwx 0
36864 .a. -/-rwxrwxrwx 0
36864 ..c
-rwxrwxrwx 0
36864 ..c -/-rwxrwxrwx 0
42496 ..c -/-rwxrwxrwx 0
32256 ..c -/-rwxrwxrwx 0
33423 ..c -/-rwxrwxrwx 0
307935 ..c -/-rwxrwxrwx 0
215895 ..c -/-rwxrwxrwx 0
22528 ..c -/-rwxrwxrwx 0
727 ..c -/-rwxrwxrwx 0
727 ..c
-rwxrwxrwx 0

00

Sat Feb 03 2001 19:44:16

rr
eta
ins

Item 9 – Timeline for Floppy Disk

Apr
Apr
Apr
Apr
Apr
Apr
Apr

26
26
26
26
26
26
26

2004
2004
2004
2004
2004
2004
2004

09:46:20
09:46:22
09:46:24
09:46:26
09:46:36
09:46:44
09:47:36

©

Mon
Mon
Mon
Mon
Mon
Mon
Mon

SA
NS
I

Mon Apr 26 2004 09:46:18

0
0
0
0
0
0
0
0
0
0
0
0
F8B5006E4
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0

5
5
17
13
28
28
23
20
27
9
23
28
A169
20
17
9
5
13
27
28
5
5
5
9
13
17
20
23
27
28
28

4E46

<v1_5.gz-_AMSHELL.DLL-dead-5>
a:\/CamShell.dll (_AMSHELL.DLL) (deleted)
a:\/Internal_Lab_Security_Policy.doc (INTERN~2.DOC)
a:\/Internal_Lab_Security_Policy1.doc (INTERN~1.DOC)
a:\/_ndex.htm (deleted)
<v1_5.gz-_ndex.htm-dead-28>
a:\/Remote_Access_Policy.doc (REMOTE~1.DOC)
a:\/Password_Policy.doc (PASSWO~1.DOC)
a:\/Acceptable_Encryption_Policy.doc (ACCEPT~1.DOC)
a:\/Information_Sensitivity_Policy.doc (INFORM~1.DOC)
a:\/Remote_Access_Policy.doc (REMOTE~1.DOC)
a:\/_ndex.htm (deleted)
a:\/Password_Policy.doc (PASSWO~1.DOC)
a:\/Internal_Lab_Security_Policy.doc (INTERN~2.DOC)
a:\/Information_Sensitivity_Policy.doc (INFORM~1.DOC)
<v1_5.gz-_AMSHELL.DLL-dead-5>
a:\/Internal_Lab_Security_Policy1.doc (INTERN~1.DOC)
a:\/Acceptable_Encryption_Policy.doc (ACCEPT~1.DOC)
<v1_5.gz-_ndex.htm-dead-28>
a:\/CamShell.dll (_AMSHELL.DLL) (deleted)
<v1_5.gz-_AMSHELL.DLL-dead-5>
a:\/CamShell.dll (_AMSHELL.DLL) (deleted)
a:\/Information_Sensitivity_Policy.doc (INFORM~1.DOC)
a:\/Internal_Lab_Security_Policy1.doc (INTERN~1.DOC)
a:\/Internal_Lab_Security_Policy.doc (INTERN~2.DOC)
a:\/Password_Policy.doc (PASSWO~1.DOC)
a:\/Remote_Access_Policy.doc (REMOTE~1.DOC)
a:\/Acceptable_Encryption_Policy.doc (ACCEPT~1.DOC)
a:\/_ndex.htm (deleted)
<v1_5.gz-_ndex.htm-dead-28>

9 of 57
© SANS Institute 2005

Author retains full rights.

Creating a String File
A ‘String File’ is the output of a search of any string of 4 or more characters in row.
In other words it is a file of all the groups of characters that may be words. This
Strings File can then be examined to gain insight into the contents of the originally
searched file or disk structure. This file can be searched using the likes of grep or
any text string search utility (even find in notepad).

fu
ll r

igh
ts.

Having obtained a file list, string file and file activity timeline, initial analysis could
occur. This resulted in list of the files on the floppy disk being made and an
examination of their size, contents and potential use being listed. The following is a
list if the files observed as being ‘live’ on the disk:
Item 10 – List of 'live' files on the floppy disk

ho

rr

eta

ins

Notes
A large file that outlined the password policy
A large file that outlined the remote access policy
A small file that outlined the internal lab policy
A small file on the policy on Information sensitivity
A small file that outlined the Encryption policy

ut

File Name
Password_Policy.doc
Remote_Access_Policy.doc
Internal_Lab_Security_Policy.doc
Information_Sensitivity_Policy.doc
Acceptable_Encryption_Policy.do
c

05
,A

Item 11 – File ownership details

root
root
root
root
root

root 42496 Apr
root 32256 Apr
root 33423 Apr
root 307935 Apr
root 215895 Apr

te

1
1
1
1
1

tu

-rwxr-xr-x
-rwxr-xr-x
-rwxr-xr-x
-rwxr-xr-x
-rwxr-xr-x

23
22
22
23
23

2004
2004
2004
2004
2004

Information_Sensitivity_Policy.doc
Internal_Lab_Security_Policy1.doc
Internal_Lab_Security_Policy.doc
Password_Policy.doc
Remote_Access_Policy.doc

In

sti

42
32
33
301
211

20

Comman ls –sl > /root/fileownershipdetails.txt
d
total =640
Key fingerprint
AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46
Output
22 -rwxr-xr-x 1 root root 22528 Apr 23 2004 Acceptable_Encryption_Policy.doc

©

SA

NS

While the accuracy of the documents in relation to the current company policies is
not something that the investigator would comment upon, the first 2 files listed
above were deemed larger that expected given their limited textual content. These
files were recorded as being ‘of interest’ and would be subjected to closer
examination later.
An examination was then made of the files that had been marked as deleted, this
included a CamShell.dll (probably a part of a program) and _ndex.htm
(probably an ‘Index.htm’ page from a website). The time-line shows a file was
deleted on 3rd Feb 2001 and that file was the CamShell.dll. A search of the
internet revealed a handful of newsgroups that referred to an old and now
unsupported program called Camouflage. Further searches led the investigator to
this web site located at the URL: <http://camouflage.unfiction.com>9 (pictured
below).
10 of 57
© SANS Institute 2005

Author retains full rights

rr

eta

ins

fu
ll r

igh
ts.

Item 12 – Screenshot of the Camouflage Website

05
,A

ut

ho

The download link was followed and the self-expanding-executable-zipped file
Camou121.exe was obtained and hashed.

Item 13 – fsum (Windows) Command output of Camou121.exe

In

sti

tu

te

20

fsum
–md5
Camou121.exe
Key fingerprint
= AF19
FA27
2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46
Command
;
SlavaSoft
Optimizing
Checksum Utility fsum 2.0
Output
<www.slavasoft.com>
;
; Generated on 11/28/04 at 22:00:14
;
c62b050117c2cba3518e5a734fedef1f *Camou121.exe

©

SA

NS

The zipped file was expanded on a control system and the contents examined. The
following image shows the file contained in the self executing zip file. It is worth
remembering that the zip folder also contains the installation software that will build
the application and create the uninstall file to facilitate its ‘safe’ removal. Once the
setup.exe file is execute the application is built with the majority of the application
being installed in the user defined folder (by default this is ‘C:\Program
Files\Camouflage’).
Item 14 – WinZip10 (Windows) contents of Camou121.exe selfextracting zip file

11 of 57
© SANS Institute 2005

Author retains full rights

igh
ts.
fu
ll r
ins
eta
rr

05
,A

ut

ho

The installation process was allowed to continue and the built application is detailed
below:
Item 15 – dir (Windows) Command output of Camouflage folder post install

te

20

dir camouflage > dir_list_camouflage_folder.txt
Command
Key fingerprint
= AF19in
FA27
2F94 998D
DE3D F8B5 06E4 A169 4E46
Volume
drive
F is FDB5
STEVE_ARMS
Output
Volume Serial Number is 70A1-3272

sti

tu

Directory of F:\GIAC\Camouflage

©

SA

NS

In

16/11/2004
16/11/2004
29/03/2001
03/02/2001
28/03/2001
08/11/2004

20:46
<DIR>
20:46
<DIR>
22:13
19:44
19:50
19:23
4 File(s)
2 Dir(s)

.
..
217,088 Camouflage.exe
36,864 CamShell.dll
11,649 Readme.txt
19,774 Uninst.isu
285,375 bytes
343,220,224 bytes free

Instantly the file called CamShell.dll jumped out as being of the same name,
capitalization and size as one of the deleted files on the floppy disk. At this point it
was decided to perform some detailed analysis on the following aspects of the
floppy disk:
The use of CamShell.dll file the associated executable
12 of 57
© SANS Institute 2005

Author retains full rights

Camouflage.exe.
The contents of the Password_Policy.doc and
Remote_Access_Policy.doc files that were unusually large and whose
size was not proportionate to their contents.

Detailed Analysis

igh
ts.

Camouflage

fu
ll r

The Camouflage program installed the CamShell.dll file into the installation
directory specified (in this case we accepted the default):
C:/Program Files/Camouflage

eta

ins

And this also includes the executable and a Readme.txt and an Uninstall data file.
The md5sums are:

rr

Item 16 – fsum (Windows) for files created by the Camouflage install process

fsum camouflage > dir_list_camouflage_folder.txt
; SlavaSoft Optimizing Checksum Utility fsum 2.0
<www.slavasoft.com>
;
; Generated on 12/07/04 at 13:30:39
;
Key fingerprint
= AF19 FA27 2F94 998D FDB5 DE3D F8B5*Camouflage.exe
06E4 A169 4E46
9f08258a80d578a0f1cc38fe4c2aebb5
4e986ab0909d2946bed868b5f896906f *CamShell.dll
0c25ad7792d555b6c8c37c77ceb9e224 *Readme.txt
2902261874a65a2581f0a260fad6a9df *Uninst.isu

sti

tu

te

20

05
,A

ut

ho

Command
Output

Item 17 – Camouflage right click menu

©

SA

NS

In

Running the Camouflage program revealed a Settings GUI and initially this
appeared to be the only impact of the installation:

13 of 57
© SANS Institute 2005

Author retains full rights

igh
ts.

Item 18 – Settings GUI window for the Camouflage program

fu
ll r

A quick read of the Readme.txt file gleaned the advisory that the use of notepad.exe
could compromise the presence of the encrypted data as it would display all data.

rr

eta

ins

This opening with notepad was performed on all live files on the floppy disk and as
thought the Password_Policy.doc and Remote_Access_Policy.doc did
seem to have encrypted within their file sectors.

05
,A

ut

ho

To test theory the Camouflage program was run for against the
Password_Policy.doc file. To do this the file was selected and the right click or
alternate menu brought up. Selecting the “Uncamouflage” option the following
window appeared:
Item 19 – Password request GUI

NS

In

sti

tu

te

20

Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

©

SA

This did present a problem as to this point no passwords had been recovered, either
in text files on in the form of an obvious file or text in a file on the disk.

Passwords
The investigator then tried a few default passwords, starting with “password” which
was rejected. The next one tried was “Password” this was the correct password as
the image below shows the contents of the Camouflaged file.
Item 20 – Camouflage Window - contents of Password_Policy.doc carrier file

14 of 57
© SANS Institute 2005

Author retains full rights

igh
ts.

Note how the 1st line of text on both screen shots shows the carrier files on the
floppy disk were created by v1.2.1 of the program (or so the program believes).

eta

ins

fu
ll r

The “Password” was then tried on the other potential carrier file but it was not
accepted. At this point the investigator was slightly stumped and began to examine
the strings file for the FD to glean any possible password. After some time and
after trying several dozen passwords gold was struck. It closer examination
indicated that the password for the Password_Policy.doc file was the first part of
the file name, thus “Remote” was tried on the Remote_Access_Policy.doc file
and the following files were revealed to inside the carrier.

05
,A

ut

ho

rr

Item 21 – Camouflage Window - contents of Remort_Access_Policy.doc

tu

te

20

Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

NS

In

sti

The having opened the CAT.mdb file in notepad.exe the string:
“M S y s A c c e s s O b j e c t s LTD”
Indicated the file was a MS Access11 file and opening it in MS Access revealed the
following:

©

SA

Item 22 – Table of CAB.mdb extracted from Remote_Access_Policy.doc

Which appears by the title of the table to be a Client database, possibly clients of
the Ballard Inc?
15 of 57
© SANS Institute 2005

Author retains full rights

05
,A

ut

ho

rr

eta

ins

fu
ll r

igh
ts.

Item 23 – fsum (windows) of all files recovered from Camouflage carrier files

NS

In

sti

tu

te

20

Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

©

SA

File Timings Explained
Before explaining what the investigator believes occurred, it is worth explaining the
somewhat unusual timings that are often connected to files that have been copied
to new media (as happened in this case).
Operating Systems. Operating Systems that are POSIX and E2 complaint
record time stamps on files when they are Modified, Accessed or Created
(called MAC times). Some like many UNIX flavours (inc Linux) apply stamps
time stamps on all activity (unless prohibited by the tool accessing the file).
Microsoft Windows however, will stamp full time and date information on
16 of 57
© SANS Institute 2005

Author retains full rights

creation and modification but only date information on file access
occurrences (the access time being stored else where).
File copying. File copying can create some strange timings as only the files
creation time and date are updated. Therefore, it is possible to make a new
file on 1st Nov, access it on the 2nd Nov, modify it on the 3rd Nov and copy it
onto separate media on the 4th; when the MACs are viewed on the 5th
however, it will appear to have been accessed and modified before it was
created.

ins

fu
ll r

igh
ts.

As will be explained in the next section, when a carrier file was modified to
include a different file, the modification time was set; when the carrier file
was copied to the floppy drive, it was given a creation time that was after the
modification time. To confuse matters more the carrier file was made using
a program that retained the MAC times of the original carried files. Thus
when the carried files are exported from the carrier file a new instance is
written to the new media and although this will have a different creation time
again, it will retain the original accessed and modification times.

rr

eta

What Happened (Investigators Opinion)

ut

ho

Having examined the data obtained from various sources and parts of the disk, the
following is offered as a possible explanation of what has been found:

te

20

05
,A

Before 23 April 2004, a Mr Robert John Leszczynski, Jr., who was employed
by Ballard Industries as the lead process control engineer for the project to
design a new fuel cell battery. Mr RJ Leszczynski, it is believed, brought a
program
(Camouflage)
Ballard
reasons
KeySteganographic
fingerprint = AF19
FA27 2F94
998D FDB5 into
DE3D
F8B5 Industries
06E4 A169for
4E46
unknown.

NS

In

sti

tu

This program may have been brought in file by file to prevent detection, as
the CamShell.dll file had deleted been on floppy disk until it was deleted.
The program was probably installed on a Ballard Ind. PC and this could be
confirmed by scanning all systems to which Leszczynski would have had
access, looking for the CamShell.dll file or remnants of it having been there.

©

SA

The Camouflage program was used to hide 4 files for transportation out of
the company grounds. The files being 2 graphical pictures and 1 an image of
a report, the 4th file was a MS database of what appears to be clients’ details.
Fortunately the Camouflage program stores the original MAC times from the
files as can be seen in items 20 and 21.
Once the Camouflage program had been used to make carrier files out of the
Password_Policy.doc and Remote_Assess_Policy.doc files [believed
to be 23 Apr 2004 @ 1155 & 1154 hours respectively].
These carrier files and four other word documents (policy documents from
Ballard Ind.) were copied onto the Floppy disk [believed to be 26 Apr 2004 @
17 of 57
© SANS Institute 2005

Author retains full rights

0946 hours]. These files accessed at some point on 26 Apr 2004, but as
Microsoft does note record access times, only dates, specific data is not
available.

igh
ts.

As Mr RJ Leszczynski, went to leave the building at the end of the day he
was stopped and the disk impounded. As the disk is logically labelled with
his initials and he was in possession of it when stopped, it is suggested that
Mr RJ Leszczynski was exporting information that he had access to, to
outside the boundary of Ballard Ind. However, analysis of his work pc would
reveal more information about his activities, and it is recommended that this
is undertaken before it is used/switched on again.
Item 24 – List of all files (inc those hidden) found of the floppy disk

File name / description

Clear or hidden and by
what
1
Acceptable_Encryption_Policy.doc
Clear
2
Internal_Lab_Security_Policy1.doc
Clear
3
Internal_Lab_Security_Policy.doc
Clear
4
Information_Sensitivity_Policy.doc
Clear
5
Password_Policy.doc
Clear
5a
Hydrocarbon%20fuel%20cell%20page2.jpg
Hidden – Camouflage
5b
pem_fuelcell.gif
Hidden – Camouflage
5c
PEM-fuel-cell-large.jpg
Hidden – Camouflage
5d
Password_Policy.doc
Hidden – Camouflage
6
Remote_Access_Policy.doc
Clear
6a
CAT.mdb
Hidden – Camouflage
6b
Remote_Access_Policy.doc
Hidden – Camouflage
Note
the
MAC
times
can
be
viewed
in
items
20
and
21
and
have
been reKey fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 not
4E46
reproduced

te

20

05
,A

ut

ho

rr

eta

ins

fu
ll r

Serial

NS

In

sti

tu

It is not possible to state if Mr RJ Leszczynski had transferred data out of the
organisation on occasions or if this was the first attempt, however, examination of
his work host PC may reveal details of the date and time the Camouflage software
was installed.

SA

The Software found and possibly used by Leszczynski

©

The program found on the disk went by the name of Camouflage. It is a
Steganographic Program that hides user selected data inside carrier files. The
following is a quote from a mirror of the old Camouflage web site12:
“What is Camouflage?
Camouflage allows you to hide files by scrambling them and then attaching
them to the file of your choice. This camouflaged file then looks and behaves
like a normal file, and can be stored, used or emailed without attracting
attention. For example, you could create a picture file that looks and
18 of 57
© SANS Institute 2005

Author retains full rights

behaves exactly like any other picture file but contains hidden encrypted
files, or you could hide a file inside a Word document that would not attract
attention if discovered. Such files can later be safely extracted. For additional
security you can password your camouflaged file. This password will be
required when extracting the files within. You can even camouflage files
within camouflaged files. Camouflage was written for use with Windows 95,
Windows 98, Windows ME, Windows NT and Windows 2000, and is simple
to install and use.”

igh
ts.

An attempt to recreate the image made by Mr R J Leszczynski failed in that the md5
hashes of the output file are not the same. That said it is unlikely that they would as
the files would be different given the different MAC times that would accompany the
files that are inserted, see below:

05
,A

ut

ho

rr

eta

ins

fu
ll r

Item 25 – Screenshot of hashes not matching

©

SA

NS

In

sti

tu

te

20

Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

Post Incident Activities
Given the severity of the incident the following activities are recommended to by
undertaken in priority order:
1.
Impound Mr R J Leszczynski’s PC and any other system on which he
had unfettered access (without powering it on) and have it Forensically
19 of 57
© SANS Institute 2005

Author retains full rights

Analysed. The hashes from items 13, 16 and 23 should be searched for on
the imaged drives (having performed a deep or recursive hash of all files on
his HDD; this will confirm or otherwise the presence of pre or post
camouflaged files.
2.
Prevent Mr R J Leszczynski from having any access to his or any
Company system, all of his accounts should be frozen immediately and any
current sessions terminated immediately; in case he tries to destroy
evidence.

igh
ts.

3.
Obtain legal advice (from the Company’s lawyers) on the possibilities
of seeking legal recompense for Mr R J Leszczynski’s actions.

fu
ll r

4.
Perform a sweep of the network for the Camshell.dll file and impound
any system reporting its presence.

rr

eta

ins

5.
Seek an Search Order under Section 7 of the Civil Procedure Act
13
1997 (formerly an ‘Anton Piller Order’ after the case of the same name),
and search and sieze his home pc and any media that may contain the
exported data. Depending on the outcome of the search and subsequent
forensic analysis of the media, sue the individual for theft of Intellectual
Property and breach of IRP.

05
,A

ut

ho

6.
Perform a re-education programme on the IT and Security policies
affecting the use of corporate and personal IT for the processing of Ballard
Ind. data.
Write to the manager of the security guard whose excellent actions
resulted in this leakage of data being stopped.
Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

20

7.

tu

te

Legal position

©

SA

NS

In

sti

As suggested above, although there has been no Criminal Law breach, the
Corporate Espionage that appears to have been conducted can be addressed
through the UK civil courts. Furthermore, this procedure carries less risk for the
Company and achieves results considerably quicker. Having consulted with several
UK IT Security lawyers it was confirmed that a Criminal case can take upto 18
months from the incident to appear in court. Additionally, the incident is turned over
to the UK Police, who conduct the investigation as best they can with shifting
priorities and reducing resources.
The civil court route places the responsibility in the Company’s hands as they
choose their investigators and legal team. The lawyers consulted spoke of cases
taking less then 4 months from incident to the court case and the aware of
damages.
Furthermore, the weight of argument required in a civilian court is less as ‘the
Balance or probabilities’ as apposed to ‘Beyond all reasonable doubt’ in a criminal
20 of 57
© SANS Institute 2005

Author retains full rights

court.
As to breaching Ballard’s own Policies, the position is not clear cut there either:
Acceptable Encryption Policy
The Camouflage program is Steganographic and therefore only hides the
data it does not encrypt it, therefore the Acceptable Encryption Policy has not
been breached.

igh
ts.

Information Sensitivity Policy

fu
ll r

Here the subject could claim they were not aware of the sensitivity of the
data he exported; however, this is unlikely to stand up to the balance of
probabilities (remembering he had probably worked there for some time as
he was the lead engineer) and there was no accident to the hiding and
passwording of these files.

eta

ins

Therefore it is suggested that Mr R J Leszczynski is in breach of paragraph
3.3 on this policy:

rr

Item 26 – Quote from Ballard Ind InformationSensivity Policy

ut

ho

3.3 Most Sensitive: Trade secrets & marketing, operational, personnel, financial, source code, & technical
information integral to the success of our company

05
,A

Marking guidelines for information in hardcopy or electronic form.

tu

te

20

Note: any of these markings may be used with the additional annotation of "3rd Party Confidential". To
indicate that Ballard Industries Confidential information is very sensitive, you may should label the
Key fingerprint
= AF19 FA27
2F94
998D and
FDB5
DE3D "Ballard
F8B5 06E4
A169Eyes
4E46
information
"Ballard Industries
Internal:
Registered
Restricted",
Industries
Only",
"Ballard Industries Confidential" or similar labels at the discretion of your individual business unit or
department. Once again, this type of Ballard Industries Confidential information need not be marked, but
users should be aware that this information is very sensitive and be protected as such.

©

SA

NS

In

sti

Access: Only those individuals (Ballard Industries employees and non-employees) designated with approved
access and signed non-disclosure agreements.
Distribution within Bright Industries: Delivered direct - signature required, envelopes stamped confidential, or
approved electronic file transmission methods.
Distribution outside of Ballard Industries internal mail: Delivered direct; signature required; approved private
carriers.
Electronic distribution: No restrictions to approved recipients within Bright Industries, but it is highly
recommended that all information be strongly encrypted.
Storage: Individual access controls are very highly recommended for electronic information. Physical security is
generally used, and information should be stored in a physically secured computer.
Disposal/Destruction: Strongly Encouraged: In specially marked disposal bins on Ballard Industries premises;
electronic data should be expunged/cleared. Reliably erase or physically destroy media.
Penalty for deliberate or inadvertent disclosure: Up to and including termination, possible civil and/or
criminal prosecution to the full extent of the law.

The Password, Remote Access and Lab Internal Security policies have no bearing
on this matter.
21 of 57
© SANS Institute 2005

Author retains full rights

In summary Mr R J Leszczynski has beached the company policy on Information
Sensitivity, and given it was on the disk with which he caused the breach, he cannot
argue that he was not aware of it either (double whammy!). It would be for the
civilian court process to decide on the level of damages that could be awarded
following a successful case, but before that is undertaken the search and seizure of
the media at Mr R J Leszczynski’s private address should be undertaken to ensure
that data is returned to the data owner and that the full extent of his activities are
declared to the courts.

Item 27 – Tools Used Matrix

fu
ll r

Linux
Windows
Windows
Windows

ins

Mozilla (version # 1.6)
Dir
WinZip (version #8.1)
Camouflage (version #1.2.1)

Describes the type and composition of a file
Performs an MD5 sum hash of a file
Performs an MD5 sum hash of a file
For virus sweeping of found files
For analysis of the recovered disk
Autopsy uses Perl scripts to run the various
Sleuth Kit commands
Used to view and control Autopsy
Lists files
Examine zip files without executing
The steganographic program examined and
believed to have been used by subject
disk’s owner

eta

Linux
Linux
Windows
Windows
Linux
Linux

05
,A

ut

ho

File
Md5sum
Fsum
Norton AntiVirus
Autopsy (version #1.70)
The Sleuth Kit

Notes

igh
ts.

Operating
System

rr

Tools

End of Part One

©

SA

NS

In

sti

tu

te

20

Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

22 of 57
© SANS Institute 2005

Author retains full rights

IT Forensic Analysis of an abandoned computer and its
Hard Disk
Background

igh
ts.

On the 31st of August 2004, while depositing some refuse at the local tip a computer
was found discarded. Inquiries with the local operative revealed that the system
had been left there the previous day. Without opening the system up, a payment of
£3 (approx ~$5) was requested from the site manage, as contribution to their ‘tea
fund’. Later investigations revealed the system to be an excellent purchase as can
be seen:

eta

ins

fu
ll r

Intel Pentium III operating at 600Mhz.but no memory (RAM)
1 x 50 speed CD ROM
Onboard sound card
Network card
1 x 6.4 Gb Integrated Disk Electronics (IDE) Hard Disk Drive (HDD)

05
,A

ut

ho

rr

The system was the removed from the facility and returned to an examination area
(investigators garage)where it was catalogued and photographed. Notice the
electrical safety check record (dated 16 April 02 to expire 16 April 03) hinting to a
production system as apposed to a home use one ; additionally the tower case from
this manufacturer ‘Epic PCs’14 also suggests the use was not a personal one.
Item 28 – Pictures of the outside of the system

SA

NS

In

sti

tu

te

20

Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

©

The side, HDD and Floppy drive removed the system was again photographed to
show age, serial numbers and general condition (notice the almost total lack of
dusk on all parts displayed).

Item 29 – Pictures of the inside of the system

23 of 57
© SANS Institute 2005

Author retains full rights

igh
ts.
fu
ll r

The HDD removed it was catalogued as:

ins

Investigation Serial number
: REC/SJA/01Aug04/HDD1
Description :
Fujitsu ATA Hard Disk Model No MPE3064AT Serial No
01334622

eta

The system as discovered minus the HDD was described and catalogued as:

05
,A

Case and Motherboard testing

ut

ho

rr

Investigation Serial number
: REC/SJA/01Aug04/BaseUnit_1
Description:
Epic tower system with CDROM, graphics card, FDD, PSU and
NIC. With the 2nd 5½ Drive bay empty and both its and the 3rd bays front missing.

te

20

The rest of the system was inspected for water or damage and with the drive
Key fingerprint
= AF19
2F94to998D
FDB5
06E4 as
A169
4E46
removed,
the system
wasFA27
powered
inspect
theDE3D
BIOSF8B5
for clues
to the
systems
use. The two main points of note when booting the system were:

sti

tu

It worked, indicating that the HDD may too be functional.

In

The BOIS time was incorrect and was approx 62 minutes fast (see the
picture below)

©

SA

NS

The BIOS date on the system was incorrect as motherboard date was the 3
Aug 2004 when in actual fact the picture below was taken on Tuesday 31st
August 2004 ie the date is out by 28 days!.
The time and date discrepancy observed was not expected and was contrary to the
general condition of the system and this hinted of either:
A lack of use (or synchronisation with an internet clock)
BIOS Battery failure – but as the right month and year were still held this was
discounted.
The user must not have noticed or has deliberately changed the time and
24 of 57
© SANS Institute 2005

Author retains full rights

date for a particular reason.
BIOS battery was low or the system had been stored in a cold environment)
failure as most mother boards alert the user to this fact, and a check with a
exhausted confirmed this motherboard to do so.

ins

fu
ll r

igh
ts.

Item 30 – BIOS Timings taken at 1733 hours on 31 August 2004

05
,A

ut

ho

rr

eta

Furthermore, any time error expected would have been in the other direction ie that
the British Summer Time (BST) clock adjustment had not been applied (BST calls
for the clock to advance 1 hour in Spring and retard 1 hour in October). The date
error perplexed the investigator but he hoped that information gathered later would
shed light on this matter, in the mean time, all dates and times would be treated
with suspicion.

tu

te

20

The function test of the remaining system complete it was sealed and stored in the
locker of the garage. Meanwhile the HDD was prepared for imaging. The
Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46
photograph below shows the hard disk installed in an external caddie ready to be
connected to the Forensic Laptop (under it).

©

SA

NS

In

sti

Item 31 – The external IDE caddie with the abandoned drive fitted

25 of 57
© SANS Institute 2005

Author retains full rights

Forensic Laptop Specification

igh
ts.

The forensic Laptop used for this examination was a Dell Inspiron 5100. The
specification of the laptop being; Intel Pentium 4 2800 MHz with 768Mb RAM, a
CDR/RW and 3com on board network card. The graphics processor was a 64 mb
Mobile ATI card with a 1024x768 TFT screen. It boasts a IEEE 1394 port as well as
2 x USB 2 ports. This laptop has more than proven itself in the past and the
performance of each of the components has been well above standard without the
need for specialist drivers. It will accept over 15 different distributions of Linux and
has run Windows from 95 – 2003 Enterprise Server. As the caddie cost in the
region of £30 (~$55), the Main Forensic OS was a free distribution(FC2) and the
laptop (inc 2 extra HDD and internal caddie drives) cost £550 (~$1030) the whole
forensic outfit was comparatively cheep £580 ($1085).

eta

ins

fu
ll r

The only glitch that was presented was with the use of the external caddie which
connects IDE devices to either IEEE 1394 or USB2. While MS Windows was able
to address the device, Fedora Core 2 did not have any support for it in the kernel.
That said some research on the internet did reveal a patch had been submitted (see
below) which when applied allowed the external caddie to be mounted in the
Fedora Core 2 (FC2) OS in read only mode.

rr

Item 32 – External Caddie OS Patch 15

ho

<alexander@all-2.com>
[PATCH] USB storage: patch for unusual_devs.h

05
,A

ut

I send a patch and copy of /proc/bus/usb/devices for my 5`25 external
USB enclosure. I don't know exactly manufacturer of this device, but
model is CD-509.
It will be nice if it helps somebody else.
http://www.linuxhq.com/kernel/changelog/v2.6/1/

20

Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

In

sti

tu

te

Note Write support for NTFS is very limited see cutting below from the Linux-NTFS
sourceforge.net web site16.
Item 33 – Quote on NFTS write support

NS

3.2 Can the Driver write to an NTFS volume, too?

©

SA

Not really, but if you only need to copy files from Linux to Windows on a dual-boot
machine, see "How to write to NTFS" below for a possible way to work around the lack of
write support. For write support in Linux, read on.
There are two drivers, currently. The original driver, in 2.4 has some write code in it, but it is
extremely dangerous to use it. The possibility of destroying your filesystem is very high.

Legal Implications of using the abandoned computer
Given the circumstances under which the system was acquired, it is worth
26 of 57
© SANS Institute 2005

Author retains full rights

recounting the legal position the author is in regarding the ownership of the system.
Section 5(1) of the Theft Act 1968 provides a legal defence to the finder of items of
property that the owner has abandoned:
Item 34 – Legal defence for Theft

5. Belonging to another
(1) Property shall be regarded as belonging to any person having possession
or control of it, or having in it any proprietary right or interest (not being an
equitable interest arising only from an agreement to transfer or grant an
interest).
Section 5 of the 1968 Theft Act17

igh
ts.

Further clarification was listed as being:

fu
ll r

If property is genuinely and honestly abandoned then it cannot be theft
because it belongs to no one.

eta

ins

However, as the item was effectively given to the site for disposal it is their property
and thus the £3 payment can be considered sufficient given that the condition of the
system was not known and that it had been left outside in the rain overnight.

05
,A

ut

ho

rr

The fact that the system had been left at a refuse tip led the author to believe that
the owner had abandoned his rights of ownership of the hardware. This is a legal
position under Section 2 of the Theft Act 1968, which allow anyone to claim
ownership of the property if they believe the owner has given up the ownership of
the property.
Content that the system had been legitimately acquired, analysis could commence.

20

Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

te

Basic Analysis

SA

NS

In

sti

tu

The Hard disk was installed into the external caddie and connected to the USB port
of the investigators patched laptop. The Linux dd command was used to copy
portions of the /dev directory in an attempt to identify which directory the drive had
been mounted to. This had proved in the investigators experience to be the best
method as the /dev directory used by the kernel varied between devices and USB
ports. The procedure involved using dd with the syntax below:

©

#/ dd if=/dev/sda of=/tmp/mount_test1
This was executed and allowed to run for several seconds before being interrupted
and the output file being examined with vi. If the output file was blank a different
/dev/ folder would b selected. Success was often being achieved within 2
guesses.
Once the correct directory was identified a dcfldd18 command was executed to
image the whole drive.

27 of 57
© SANS Institute 2005

Author retains full rights

Item 35 – Imaging in progress

igh
ts.

The dcfldd command (written by the Defence Computer Forensics Laboratory as
indicated by the ‘dcfl’ bit inform of the dd) was used image process as it is an
improvement over the native dd command. The labs basically modified the native
dd command so it performs an MD5 hash of the HDD as it images it (in the above
screenshot it is the ‘hashlog’) and it also displays the counters showing the
progress of the execution.

05
,A

ut

ho

rr

eta

ins

fu
ll r

Once the whole disk image had been performed an md5 hash was taken of the
source drive and this was compared with dcfldd hashlog. As these were found to
be exactly the same the investigator has assumed the image file to be a bit-for-bit
copy of the /dev/sda drive. The image of the drive that then obtained file was made
read only (using the chmod 444 <image_file> command). To prevent any file
handling errors from disrupting the investigation, the image file was copied to a
different folder /root/datavault to allow copies to be made should a working
copy be corrupted in any way. Once copied to the second location, an md5 hash
was taken and stored in a separate file in the /root/datavault. This hash
matched the original image file and the source drive itself and would serve as a
reference should any one wish to confirm the authenticity of any file used or
obtained during this investigation.

tu

te

20

The file command was used in an effort to identify the contents of the file. The
file
command
the contents
of FDB5
an object,
structure
text within
Key
fingerprintexamines
= AF19 FA27
2F94 998D
DE3DitsF8B5
06E4 and
A169the
4E46
it, in an effort to classify what this object is. The output of the file upon the drive
image was:

sti

Unknown_hdd_dfcldd_sda: x 86 boot sector

©

SA

NS

In

Next the process is repeated for the first partition on the drive which was mounted in
the /dev/sda1 directory. The md5 hash, copying to the /root/datavault,
chmod and file process was again repeated and the file command was used to
examine the contents. This time the output was:
Item 36 – Output from the file command

Unknowndcfldd_hdd_sda1_dd: x86 boot sector, code
offset0x58, OEM-ID “MSWIN4.1”, sectors/cluster 8, Media
descriptor 0xf8, heads 255, hidden sectors 63, sectors
12659157 (volumes > 32 MB) , FAT (32 bit), sectors/FAT
12342, reserved3 0x800000, serial number 0x1c12160a,
unlabeled
A look at the Microsoft web site19 decoded the MSWIN4.1 as:
28 of 57
© SANS Institute 2005

Author retains full rights

Item 37 – Quote from Microsoft explaining the HDD ID Tag

You might also see the OEM ID "MSWIN4.0" on disks formatted by
Windows 95 and "MSWIN4.1" on disks formatted by Windows 95 OEM
Service Release 2 (OSR2), Windows 98, and Windows Me. Windows XP
Professional does not use the OEM ID field in the boot sector except for
verifying NTFS volumes.

igh
ts.

Therefore, it is assumed that the hard disk was formatted with either Windows 95
(OSR2), Windows 98 or Windows ME. Whilst it is not impossible for this to be a
production system, this latest fact would more than hint to a personal user.

ins

fu
ll r

With the image marked as read-only in the Linux file permissions, the image was
mounted as a loop-back read only device in the /mnt/unknown directory. This
was to allow the investigator see for the first time the directory structure.
Additionally, as both the mount command and the Linux file permissions were set to
read-only, browsing could be undertaken without fear of altering the data.

05
,A

ut

ho

rr

eta

Item 38 – First look at the imaged file structure

20

Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

do not hide entries starting with .
print octal escapes for non graphic characters
use a long list format but do not list group

©

SA

-a
-b
-o
information

NS

In

sti

tu

te

A cursory examination of this the root of the system, would confirm the file
identification of the early personal edition of Windows. Files like the
autoexec.bat and config.sys are not used on windows NT (any version) and
the FAT32 file structure was not readable by NT. In order that we might learn the
install date of the operating system the ls command was executed with the ‘ -abo ’
switches. These have the effect of displaying (taken from the ls manual):

This produced the following output:
Item 39 – Initial look at file ownership and their associated creation times/dates

29 of 57
© SANS Institute 2005

Author retains full rights

igh
ts.
fu
ll r
20

05
,A

ut

ho

rr

eta

ins

It is a known fact that Windows 9x and ME used fixed dates for the creation times
and dates for its system files, directories and applications installed from the
CDROM. However, as the OS is installed on the disk the new directories created
as a result of the OS operation will be given the local, natural, real time and date
settings (assuming the end user set the time and time zone correctly). Therefore, is
can be assumed that the OS was installed on 2nd February 2004 given the data
associated with the ‘Windows’, ‘My Documents’, ‘Program Files’ directories
and the stamps on the setuplogs.old, setup.txt and system.1st files.
While some time and date errors have been found, the windows process of
requesting the user to set the correct date, time and time zone are at this point
Key fingerprint
= AF19
FA27
2F94
FDB5 DE3Dentered
F8B5 06E4
A169 4E46
assumed
to have been
done
and
that998D
the information
is accurate.

In

sti

tu

te

Finally, vi is used to display the contents of the command.com file as this would be
used to start a command shell and MS Windows OS always reports the host OS at
the top of any new shell. The screenshot below confirms the presence of a
Windows 9820 installation.

©

SA

NS

Item 40 – Windows version extracted from the shell

Before concluding the basic analysis, an assessment of the role the system
30 of 57
© SANS Institute 2005

Author retains full rights

operated under before disposal was conducted. The key factors in this are the files
and directory structure, the OS, the systems hardware and the manner and style of
disposal. The assessment is split into factors for the business use and factors for
the private use.

Business Use:

igh
ts.

3.

Business type case (ie tower).
Electrical Safety Check sticker on the case, would indicate a Health and
Safety requirement for the system owner to ensure the user’s system is safe
to use. The investigator had never heard of any one having such tests
performed on home electrical appliances (due to cost).
The case was very clean inside indicating either regular and thorough
cleaning or the fact the system was in an air conditioned environment.

fu
ll r

1.
2.

Personal Use:

Operating System use is a classic home user one.
The age of the operating system (6 years) would indicate it was a outright
purchase and not on contract for regular or frequent updating.
3.
The system was a reasonable specification and in business would most
likely have been reused for some other task as it met the min spec for
Windows 2000 Professional, Windows 2003 Server and XP Pro (or home).
However, given the current specification of home systems is would be
considered dated and limited.
4.
The Team17 folder would indicate the presence of a game (as Team17
install their games to these folders eg Worms), unlikely (but not impossible)
it to be used
onFA27
a business
system.
Keyfor
fingerprint
= AF19
2F94 998D
FDB5 DE3D F8B5 06E4 A169 4E46

20

05
,A

ut

ho

rr

eta

ins

1.
2.

tu

The system appears to be both and it is therefore believed it was indeed
used for business purposes up to some time after 16 April 2002 when the
electrical safety check was performed.
It was then possibly transferred to a home user where most recently on the
2nd February 2004 Windows 98 was installed.

NS

2.

In

sti

1.

te

Conclusion

SA

Key areas and direction for Detailed Analysis

©

It is important when performing any detailed task to have both objectives and
direction otherwise time and effort can be wasted proving points that are not
relevant or of value to the investigation. The following will be used to direct
investigation and data recovery during the next stage. The success and
performance of the forensic examination and analysis will be gauged against these
objectives.

31 of 57
© SANS Institute 2005

Author retains full rights

Investigation Objectives
System Objectives – (Identify)
Operating System
Current OS
Previous OS
Last booted / shutdown (date and time)
User Objectives – (Identify)
The common and or last user
Owner (physical and email addresses)
IP Address of the last user
General User activity
Hidden software Objectives
Locate and identify any Viruses
Locate and identify any Spyware
Locate and identify any Malware
Locate and identify any Trojans
Legal Objectives
Identify any illegal activity
Identify any illegal software

Comments

if identifiable
Comments

fu
ll r

Comments

igh
ts.

Not for print in this report
Static IP not inc in this report

ins

Comments

eta

Number
S1
S2
S3
S4
Number
U1
U2
U3
U4
Number
H1
H2
H3
H4
Number
L1
L2

ho

rr

Detailed Analysis

tu

te

20

05
,A

ut

The detailed analysis commenced with the starting of the Autopsy (v1.70) and
mounting of the disk images to the software. Autopsy given the investigator the
option to adjust the time zone and mount time of the files to reflect minor
discrepancies in the clock of the system. This would mainly be used when several
systems are being compared and all times need to be accurate to an external
Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46
reference. As this was the only system being analysed, it was not necessary and
the time zone was set only to Greenwich Mean Time and British Summer Time
(GMTBST).

©

SA

NS

In

sti

Once mounted the system was subject to an md5 hash and this was compared to
that of the original dcfldd hashoutput. Next the file browser window was
opened and a general examination of the contents of the drive was conducted. The
date and time that the %systemroot%/win386.swp held should have indicated
the last point at which the OS conducted any swap operations. Swap operations
are where data in memory is ‘paged’ or ‘swapped’ to the hard disk. This is used to
allow the multitasking of the OS to be undertaken when it has insufficient RAM to
host itself, the drivers and the applications.
In a typical Windows system the OS consumed up to 60% of the available RAM so
the swap file was in regular use. When shut down, the swap file is one of the last
files accessed and closed and as a result it is usually a good indication of the last
time the system was used ie 15th July 2004 @ 1937 hours (GMTBST). However,
the file picture directly above the win386.swp is the win.ini file, which is used
store the configuration of the OS (only Win 9x and ME used this feature as the
registry is used by NT, 2000, XP and 2003), and this file has a date of 17th August
32 of 57
© SANS Institute 2005

Author retains full rights

2004! So a full time line analysis will be conducted on the information extracted via
Autopsy.

rr

eta

ins

fu
ll r

igh
ts.

Item 41 – Possibly the last use of the system

©

SA

NS

In

sti

tu

te

20

05
,A

ut

ho

The creation of the time line was the next objective. This would show the creation,
modification and access times (MAC) for all current files. It would also obtain from
the meta data the MACs for the files that have been deleted, this is less accurate as
the meta data deteriorates when parts of the disk are reused. However, as we
believe the system was a home PC that may have been used by a business, some
remnants
of the old
data or
data2F94
structures
may DE3D
remain.
The06E4
Autopsy
tool
Key fingerprint
= AF19
FA27
998D FDB5
F8B5
A169 4E46
interface was directed to create the time line and the output analysed in a text
reader (as the web browser is not ideal and cannot handle long documents very
well).

33 of 57
© SANS Institute 2005

Author retains full rights

fu
ll r
igh
t
5,
A

ut

ho

rr
eta
ins

Item 42 – Cutting from System Time Line

©

SA
NS
I

ns

tit

ut

e2

00

Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

34 of 57
© SANS Institute 2005

Author retains full rights.

Sun

tit

©

Mon

ns

Mon

SA
NS
I

Mon

ut

e2

Mon

00

Fri
Thu

5,
A

ut

Sun
Mon

Mon
Mon

fu
ll r
igh
t

0

1188829 <unknowndcfldd_hdd_sda1_dd-_SL7235.TMP-dead-1188829>
6
c:\/FRUNLOG.TXT
1188829 c:\/WINDOWS/TEMP/_SL7235.TMP (deleted)
1188829 c:\/WINDOWS/TEMP/_SL7235.TMP (deleted)
0
1188829 <unknowndcfldd_hdd_sda1_dd-_SL7235.TMP-dead-1188829>
0
1740848 c:\/WINDOWS/COMMAND/SCANDISK.INI
0
1740816 c:\/WINDOWS/COMMAND/SCANDISK.EXE
0
27
c:\/SCANDISK.LOG
0
27
c:\/SCANDISK.LOG
0
94135322 <unknowndcfldd_hdd_sda1_dd-_TA95930-dead-94135322>
0
94135323 <unknowndcfldd_hdd_sda1_dd-_TB95930-dead-94135323>
0
94135312 <unknowndcfldd_hdd_sda1_dd-_ISTRENU.DLL-dead-94135312>
0
94135310 <unknowndcfldd_hdd_sda1_dd-_EOTRACE.EXE-dead-94135310>
0
94135947 <unknowndcfldd_hdd_sda1_dd-_TXCON~1.HTM-dead-94135947>
0
94135322 <unknowndcfldd_hdd_sda1_dd-_TA95930-dead-94135322>
0
94135323 <unknowndcfldd_hdd_sda1_dd-_TB95930-dead-94135323>
DE3D
06E4 A169
4E46
0 F8B5 94134854
<unknowndcfldd_hdd_sda1_dd-_TJ74961-dead-94134854>
0
94134796 <unknowndcfldd_hdd_sda1_dd-_WHOME.DLL-dead-94134796>
0
94134794 <unknowndcfldd_hdd_sda1_dd-_WPLUGIN.DLL-dead-94134794>
0
94134849 <unknowndcfldd_hdd_sda1_dd-_TE74961-dead-94134849>
0
94134850 <unknowndcfldd_hdd_sda1_dd-_TF74961-dead-94134850>
0
94134798 <unknowndcfldd_hdd_sda1_dd-_WHOME~1.DLL-dead-94134798>
0
94134848 <unknowndcfldd_hdd_sda1_dd-_TD74961-dead-94134848>
0
94134811 <unknowndcfldd_hdd_sda1_dd-_WCORE.DLL-dead-94134811>
0
94134855 <unknowndcfldd_hdd_sda1_dd-_TK74961-dead-94134855>
0
94134819 <unknowndcfldd_hdd_sda1_dd-_WRULE~1.DLL-dead-94134819>
0
94134846 <unknowndcfldd_hdd_sda1_dd-_TB74961-dead-94134846>
0
94134860 <unknowndcfldd_hdd_sda1_dd-_TP74961-dead-94134860>
0
94134847 <unknowndcfldd_hdd_sda1_dd-_TC74961-dead-94134847>
0
94134823 <unknowndcfldd_hdd_sda1_dd-_WCHECK.DLL-dead-94134823>
0
94134821 <unknowndcfldd_hdd_sda1_dd-_WSETUP.DLL-dead-94134821>
0
94134827 <unknowndcfldd_hdd_sda1_dd-_CRTL32.DLL-dead-94134827>
0
94134858 <unknowndcfldd_hdd_sda1_dd-_TN74961-dead-94134858>
0
94134856 <unknowndcfldd_hdd_sda1_dd-_TL74961-dead-94134856>
0
94134831 <unknowndcfldd_hdd_sda1_dd-_FW.CHM-dead-94134831>
0
94134829 <unknowndcfldd_hdd_sda1_dd-_LSXPAND.DLL-dead-94134829>
0
94134859 <unknowndcfldd_hdd_sda1_dd-_TO74961-dead-94134859>
0
94134825 <unknowndcfldd_hdd_sda1_dd-_PD.EXE-dead-94134825>
0
94134833 <unknowndcfldd_hdd_sda1_dd-_ICENSE.PDF-dead-94134833>
0
94134864 <unknowndcfldd_hdd_sda1_dd-_TR74961-dead-94134864>
0
94134859 <unknowndcfldd_hdd_sda1_dd-_TO74961-dead-94134859>
0
94134854 <unknowndcfldd_hdd_sda1_dd-_TJ74961-dead-94134854>
0
94134853 <unknowndcfldd_hdd_sda1_dd-_TI74961-dead-94134853>
0
94134858 <unknowndcfldd_hdd_sda1_dd-_TN74961-dead-94134858>
0
94134849 <unknowndcfldd_hdd_sda1_dd-_TE74961-dead-94134849>
0
94134839 <unknowndcfldd_hdd_sda1_dd-_TA74961-dead-94134839>
0
94134863 <unknowndcfldd_hdd_sda1_dd-_TQ74961-dead-94134863>
0
0
0

ho

Thu

0 ..c -rwxrwxrwx 0
654 m.. -/-rwxrwxrwx 0
0 ..c -/-rwxrwxrwx 0
Aug 19 2004 15:55:36
0 m.. -/-rwxrwxrwx 0
0 m.. -rwxrwxrwx 0
Aug 22 2004 00:00:00
7329 .a. -/-rwxrwxrwx 0
143818 .a. -/-rwxrwxrwx 0
12161 .a. -/-rwxrwxrwx 0
Aug 22 2004 10:55:16
12161 m.. -/-rwxrwxrwx 0
Oct 13 1930 09:02:20
606252 ..c -rwxrwxrwx 0
552960 ..c -rwxrwxrwx 0
552960 ..c -rwxrwxrwx 0
606252 ..c -rwxrwxrwx 0
Nov 21 1930 08:44:30
660 ..c -rwxrwxrwx 0
Nov 27 1930 17:31:44
606252 .a. -rwxrwxrwx 0
552960 .a. -rwxrwxrwx 0
Key
fingerprint
= AF19159744
FA27..c
2F94
998D FDB5
Jan 19
1931 08:41:58
-rwxrwxrwx
0
258100 ..c -rwxrwxrwx 0
159744 ..c -rwxrwxrwx 0
258100 ..c -rwxrwxrwx 0
319543 ..c -rwxrwxrwx 0
319543 ..c -rwxrwxrwx 0
Jan 19 1931 08:42:00
299008 ..c -rwxrwxrwx 0
299008 ..c -rwxrwxrwx 0
Jan 19 1931 08:42:02
184320 ..c -rwxrwxrwx 0
184320 ..c -rwxrwxrwx 0
Jan 19 1931 08:42:08
77824 ..c -rwxrwxrwx 0
586860 ..c -rwxrwxrwx 0
106496 ..c -rwxrwxrwx 0
106496 ..c -rwxrwxrwx 0
143360 ..c -rwxrwxrwx 0
58368 ..c -rwxrwxrwx 0
58368 ..c -rwxrwxrwx 0
143360 ..c -rwxrwxrwx 0
586860 ..c -rwxrwxrwx 0
5120 ..c -rwxrwxrwx 0
5120 ..c -rwxrwxrwx 0
77824 ..c -rwxrwxrwx 0
Jan 19 1931 08:42:12 2235610 ..c -rwxrwxrwx 0
2235610 ..c -rwxrwxrwx 0
Feb 16 1931 17:31:44
5120 .a. -rwxrwxrwx 0
159744 .a. -rwxrwxrwx 0
106496 .a. -rwxrwxrwx 0
58368 .a. -rwxrwxrwx 0
258100 .a. -rwxrwxrwx 0
208896 .a. -rwxrwxrwx 0
42634 .a. -rwxrwxrwx 0

rr
eta
ins

Thu Aug 19 2004 15:55:34

35 of 57
© SANS Institute 2005

Author retains full rights.

fu
ll r
igh
t
rr
eta
ins
ho
ut
5,
A

©

SA
NS
I

ns

tit

ut

e2

00

Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

36 of 57
© SANS Institute 2005

Author retains full rights.

As can be seen above the time line revealed some very confusing data, especially
given the assumption that the system was not used after 15 Jul 2004 when the
windows swap file was last accessed. Although, the clock was believed to be
inaccurate (being out by approximately 27 days and 62 minutes), some MACs
claimed creating and access dates in the 1930s! This may be attributable to meta
data being corrupt as few computers will allow their clock to be set so far in the
past.

ins

fu
ll r

igh
ts.

Ignoring the 1930s data, the last entry is the c:\scandisk.log which has a time
stamp of 22nd August 2004 11:55 and 16 seconds. An examination of the log itself
reveals the entry which matches the timestamp. Interestingly though, the
scandisk.log file was created on 2nd Feb 2004 – the believed built date for the
OS., however, the first scan recorded is on 11th Aug 2004 (and this was cancelled)
only indicating a developing problem that required more and more attention from the
user. Below is a summary of the scandisk.log file that has had the extra
carriage returns removed and where a scan revealed no problem the text was
removed.

05
,A

ut

ho

rr

eta

Item 43 – Summary of the scandisk.log for the system

©

SA

NS

In

sti

tu

te

20

Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

37 of 57
© SANS Institute 2005

Author retains full rights

*******************
Microsoft ScanDisk for Windows
NOTE: If you use an MS-DOS program to view this file, some of the characters
may appear incorrectly. Use a Windows program such as Notepad instead.
Log file generated at 09:50 on 8/11/2004.
ScanDisk used the following options:
Thorough test
Automatically fix errors
Drive (C:) contained the following errors:
ScanDisk was canceled.

Directory structure & File

igh
ts.

File system

File system

File system

fu
ll r

------------------Log file generated at 05:12PM on Tuesday, August 17, 2004.
ScanDisk checked drive C for problems, with the following results:
system
Log file generated at 05:15PM on Tuesday, August 17, 2004.
ScanDisk checked drive C for problems, with the following results:
Log file generated at 05:44PM on Tuesday, August 17, 2004.
ScanDisk checked drive C for problems, with the following results:
Log file generated at 05:55PM on Tuesday, August 17, 2004.
ScanDisk checked drive C for problems, with the following results:
Log file generated at 08:23PM on Tuesday, August 17, 2004.
ScanDisk checked drive C for problems, with the following results:
Log file generated at 03:57PM on Thursday, August 19, 2004.
ScanDisk checked drive C for problems, with the following results:
Log file generated at 03:58PM on Thursday, August 19, 2004.
ScanDisk checked drive C for problems, with the following results:
Log file generated at 04:00PM on Thursday, August 19, 2004.
ScanDisk checked drive C for problems, with the following results:
Log file generated at 04:03PM on Thursday, August 19, 2004.
ScanDisk checked drive C for problems, with the following results:
Log file generated at 05:27PM on Thursday, August 19, 2004.
ScanDisk checked drive C for problems, with the following results:
Log file generated at 05:37PM on Thursday, August 19, 2004.
ScanDisk checked drive C for problems, with the following results:
Log file generated at 05:42PM on Thursday, August 19, 2004.
ScanDisk checked drive C for problems, with the following results:
Log file generated at 06:10PM on Thursday, August 19, 2004.
ScanDisk checked drive C for problems, with the following results:
Log file generated at 09:57PM on Thursday, August 19, 2004.
ScanDisk checked drive C for problems, with the following results:
Log file generated at 10:22PM on Thursday, August 19, 2004.
Key fingerprint
= AF19
2F94with
998D
DE3D
F8B5
ScanDisk
checked drive
C for FA27
problems,
theFDB5
following
results:
Log file generated at 01:46PM on Friday, August 20, 2004.
ScanDisk checked drive C for problems, with the following results:
Log file generated at 01:48PM on Friday, August 20, 2004.
ScanDisk checked drive C for problems, with the following results:
Log file generated at 01:52PM on Friday, August 20, 2004.
ScanDisk checked drive C for problems, with the following results:
Log file generated at 01:58PM on Friday, August 20, 2004.
ScanDisk checked drive C for problems, with the following results:
Log file generated at 03:48PM on Friday, August 20, 2004.
ScanDisk checked drive C for problems, with the following results:
Log file generated at 05:08PM on Friday, August 20, 2004.
ScanDisk checked drive C for problems, with the following results:
Log file generated at 06:37AM on Saturday, August 21, 2004.
ScanDisk checked drive C for problems, with the following results:
Log file generated at 08:25AM on Sunday, August 22, 2004.
ScanDisk checked drive C for problems, with the following results:
Log file generated at 10:55AM on Sunday, August 22, 2004.
ScanDisk checked drive C for problems, with the following results:

File system

File system

06E4system
A169
File

4E46

File system

File system

File system

©

SA

NS

In

sti

tu

te

20

05
,A

ut

ho

rr

eta

ins

File system

What is apparent is that the first check was requested/required by either the user of
the system (upon boot), on 11 Aug 2004 then over the next 11 days a further 23
scans were imitated. This would indicate a failing of either the physical disk, the
operating system or the presence of some software that was causing the system to
crash, whereupon reboot a scandisk would automatically be invoked (and
conducted unless cancelled by the user).
38 of 57
© SANS Institute 2005

Author retains full rights

Furthermore a look at the MAC of the boot.log reveals a stamp of 17 Aug 2004:
Item 44 – MAC for the boot.log
Tue Aug 17 2004 17:26:30

55277 m.. -/-r-xr-xr-x 0

0

5

c:\/BOOTLOG.TXT

igh
ts.

This hints strongly of a system that is failing and was operational for the last time on
17 Aug 2004. This with the scandisk.log file (above) suggests the user would
attempt to booth the system (generally in the evening) and allowing it to conduct
several scans in an effort to correct whatever problem prevents normal system
operation. The scans do not appear to correct the problem and user gives up after 35 attempts.

fu
ll r

It is the assumption of the investigator that the user gives up on 22 August 2004,
believing the disk to be corrupt elects to scrap the system some time over the next
week.

ins

Why did the system fail?

ho

rr

eta

Given the fact that the investigator was able to image the hard disk without
any problems, it is surmised that the errors on the disk were software related. With
this in mind the investigator looked for recent software installations that may have
corrupted the logical integrity of the operating system on the hard disk.

05
,A

ut

Large numbers of files downloaded with a peer-2-peer software; there are
traces of 4 such programs:
Kazaa Lite21
<http://www.kazaalite.nl/en> (c:\Program
Files
)
Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

20

a.

Kazaa Lite K++22 <http://www.kl-kpp.net/>

c.

Grokster23
Files)

d.

MorpheusUltra24

<http://www.grokster.com>

(c:\Program Files)
(c:\Program

<http://www.morpheusultra.com> (c:\softwrap)

NS

In

sti

tu

te

b.

SA

Peer-2-peer software is a classic method of catching viruses, downloading Trojans
and other Malware or Spyware.

©

In order that a Windows Spyware and Antivirus program could be loaded and
run against the image, it was necessary to mount the dd image on a samba shared
folder and to sweep the files remotely. First the mount command was used to
mount the image onto the /mnt/windows_forensic_server directory which
samba had been configured serve via Windows SMB file sharing protocol. Access
was restricted to a the sole Windows system to be used to conduct further analysis.
Although the image file itself is read only, the mount point is also defined as being
read only.
39 of 57
© SANS Institute 2005

Author retains full rights

Item 45 – Mounting the Image in Read Only mode25

The set up was as follows:

05
,A

ut

ho

rr

eta

ins

fu
ll r

igh
ts.

The Laptop applied samba share level permissions to the Administrator of the
Windows XP desktop. This intern was connected via a separate network card with
a different address to a switch. The switch allowed access to the Green Interface
on the Smoothwall26 <www.smoothwall.org> Internet Firewall. The internet
connection was enabled on the XP Pro system when an item required researching
on the Internet, otherwise it was disabled. To reach the image from the internet, an
attacker would be required to defeat the Smoothwall Firewall, identify the internal
NATed address range, defeat the Norton Personal Firewall installed on the XP Pro
system, enable IP Forwarding or install Windows Internet Connection Sharing (ICS),
identify the IP Address of the Linux system and defeat the OS firewall installed.
Therefore the investigator considered the read only samba shared data to
reasonably safe – although as mentioned the connection to the Internet was limited
and tightly controlled.
Item 46 – Diagram of the Network used27

SA

NS

In

sti

tu

te

20

Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

©

The purpose of the samba share was to allow the use of windows based tools (with
which the investigator was more familiar). Upon connecting to the read only
network share, a complete copy of the contents was taken to a temporary directory
E:\GIAC SANS TEMP\. This was in case any of the Trojan hunting software tried
to remove or alter the data. Although the data was safe, AntiVirus and Anti Malware
software have a bad habit of freezing when they attempted to delete data that was
prohibited by more than the system’s own file permissions. Note as standard
practice, all products were updated moments before being used on the target
image.
40 of 57
© SANS Institute 2005

Author retains full rights

AntiVirus, Trojan and Malware Scans
The investigator recognised that the fact that only complete files were visible and
that any viruses etc held in slack or unused space would not be found by searching
through samba shared data, he believed there would be sufficient to be going on,
furthermore, a full slack and deleted file search would be conducted on the host
Linux system.

igh
ts.

The first a Virus Scan was performed using Norton Anti Virus a good produce that
the investigator is familiar with, it is configurable and it will detect Trojans, Viruses,
Worms and {as we will see only some} Malware. On this occasion it revealed one
virus called ‘polmx2.cab’ which it classed as a Trojan.

ho

rr

eta

ins

fu
ll r

Item 47 – Norton Anti Virus Discovered Trojan

05
,A

ut

A check of the complete timeline revealed the Trojan was created on the disk and
modified on the times shown below:
Item 48 – Creation and modification MACs for ‘POLMX2.CAB’ Trojan

Key fingerprint = AF19
2F94 998D
DE3Dc:\/WINDOWS/TEMP/polmx2.cab
F8B5 06E4 A169 4E46(POLMX2.CAB)
42036 FA27
..c -/-rwxrwxrwx
0 0FDB5
1188717

Fri Jun 18 2004 16:09:22

Fri Jun 18 2004 16:09:26

357 ..c -/-rwxrwxrwx 0
37888 ..c -/-rwxrwxrwx 0

Tue Jun 22 2004 00:00:00

42036 .a. -/-rwxrwxrwx 0
357 .a. -/-rwxrwxrwx 0
4096 .a. d/drwxrwxrwx 0

1188723
1188729

0
0
0

1188717 c:\/WINDOWS/TEMP/polmx2.cab (POLMX2.CAB)
1903505 c:\/WINDOWS/INF/POLMX2.INF
26855989 c:\/MYDOCU~1/2003_0~1/New Folder

357 .a. -/-rwxrwxrwx 0
37888 .a. -/-rwxrwxrwx 0
4096 .a. d/drwxrwxrwx 0

0
0
0

1188723 c:\/WINDOWS/TEMP/polmx2.inf (POLMX2.INF)
3223257 c:\/WINDOWS/POLMX2.EXE
26855991 c:\/MYDOCU~1/2003_0~1/New

37888 .a. -/-rwxrwxrwx 0

0

tu

te

20

0
0

In

sti

(NEWFOL~1)

NS

Folder(1)(NEWFOL~2)

1188729

c:\/WINDOWS/TEMP/polmx2.inf (POLMX2.INF)
c:\/WINDOWS/TEMP/polmx2.exe (POLMX2.EXE)

c:\/WINDOWS/TEMP/polmx2.exe (POLMX2.EXE)

©

SA

The second Virus scan (its always a good idea to do at least two), was performed
by the Free AVG Antivirus28 tool <http://www.grisoft.com> this revealed a
significantly larger number, 32! Although this may be because of the overlap in
what AVG, Norton and Spyware Doctor29 all scan for.
Item 49 – AVG Scan Results

41 of 57
© SANS Institute 2005

Author retains full rights

igh
ts.
fu
ll r

eta

ins

Next up was a scan for Spyware, this was conducted using the PCtools Spyware
Doctor (www.pctools.com/spyware-doctor). If the Norton result was bad, the
Spyware doctor result was horrendous, as it discovered 85 instances of Spyware or
Trojans.

05
,A

ut

ho

rr

Item 50 – Spyware found by Spyware Doctor on the HDD

In

sti

tu

te

20

Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

NS

Given the number of items discovered, it is the believed that either:

©

Or

SA

The user became aware of the number of item of Spyware to the point where
they took action and removed something critical.

The system simply failed under then number of malicious item of software
running.
Or both, in that the system caused so many problems that the user took action and
the software used caused the system to fail by either removing an infected file that
was critical to the OS or by failing to install itself properly and corrupting the system
partition in the process.
42 of 57
© SANS Institute 2005

Author retains full rights

An examination of the time line in the last few days gives some hint as which
it these is the case. Some items have been highlighted in the next portion of the
time line:
The red indicate the presence of a malicious file or Trojan.
The blue indicate the presence of a defensive tool.

igh
ts.

The Trojan installed is call (by Trendmicro.com) TROJ_RVP.d and the screen shot
shows the files it installs, all of which can be seen in the time line.

05
,A

ut

ho

rr

eta

ins

fu
ll r

Item 51 – TrendMicro details on TROJ_RVP.D Trojan30

sti

tu

te

20

Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

©

SA

NS

In

The time line shows that just 5 minutes later the user attempted to install a
defensive piece of software in the form of ‘Spyblocker’ from <www.spyblockersoftware.com> , this can be seen from the time line entries coloured blue, that
relate to the installation and modification of 6 files, as referred to in the installation
report on the company’s web site31:
Item 52 – Installation report for Sypblocker

43 of 57
© SANS Institute 2005

Author retains full rights

http://www.spyblocker-software.com/spyblocker/instrpt.htm
Installation Report: GP-Install
Generated by InCtrl5, version 1.0.0.0
Install program: C:\trysb\spyblock.exe
3/22/2002 12:34 AM
<cut for brevity>

tu

te

20

05
,A

ut

ho

rr

eta

ins

fu
ll r

igh
ts.

Files changed: 6
c:\dialer\PACKET.DAT
Old date: 3/22/2002 12:26 AM
New date: 3/22/2002 12:33 AM
Old size: 111 bytes
New size: 117 bytes
c:\WINDOWS\GPInstall.exe
Old date: 1/1/2002 12:39 PM
New date: 3/22/2002 12:27 AM
Old size: 796,672 bytes
New size: 796,672 bytes
c:\WINDOWS\POWERPNT.INI
Old date: 3/19/2002 12:02 PM
New date: 3/22/2002 12:28 AM
Old size: 60 bytes
New size: 60 bytes
c:\WINDOWS\SYSTEM.INI
Old date: 3/19/2002 5:14 PM
New date: 3/22/2002 12:28 AM
Old size: 2,206 bytes
New size: 2,206 bytes
c:\WINDOWS\WAVEMIX.INI
Old date: 3/19/2002 12:02 PM
New date: 3/22/2002 12:28 AM
Old size: 54 bytes
New size: 54 bytes
c:\WINDOWS\APPLOG\APPLOG.ind
OldKey
date:
3/22/2002
12:20
fingerprint
= AF19
FA27AM
2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46
New date: 3/22/2002 12:27 AM
Old size: 10,151 bytes
New size: 10,215 bytes

In

sti

However, the install does not go well and the installation process is not completed,
as the next files modified are boot process ones suggesting that the install crashes
the system, possible through conflict with any one of a number of Trojans.
634912 m.. -/---x--x--x 0

0

3223244

0

3222895

c:\/WINDOWS/WAVEMIX.INI

0

3222851

c:\/WINDOWS/SYSTEM.INI

0
0

3222898
3222895

c:\/WINDOWS/POWERPNT.INI
c:\/WINDOWS/WAVEMIX.INI

60 m.. -/-rwxrwxrwx 0
56886 m.. -/-r-xr-xr-x 0
108 m.. -/-r-xr-xr-x 0

0
0
0

3222898
28
3223082

c:\/WINDOWS/POWERPNT.INI
c:\/BOOTLOG.PRV
c:\/WINDOWS/ttfCache

55277 m.. -/-r-xr-xr-x 0

0

5

c:\/BOOTLOG.TXT

NS

Tue Aug 17 2004 17:10:40

SA

Tue Aug 17 2004 17:16:08
Tue Aug 17 2004 17:16:10

(TTFCACHE)

©

Tue Aug 17 2004 17:16:38

Tue Aug 17 2004 17:26:30

54
2151
60
54

..c
..c
..c
m..

-/-rwxrwxrwx
-/-rwxrwxrwx
-/-rwxrwxrwx
-/-rwxrwxrwx

0
0
0
0

c:\/WINDOWS/USER.DAT

From this point on the time line becomes corrupt and few entries are clear or
logical. As seen from the scandisk.log file earlier the system now starts the
sequence of what will become 23 scandisk checks that will fail to fix the problem
and the system appears to never boot correctly again.
The reb dotted line indicates a point after which the disk records become so garbled
that they fail to make any sense. The investigator believes the exhaustive number
44 of 57
© SANS Institute 2005

Author retains full rights

05
,A

ut

ho

rr

eta

ins

fu
ll r

igh
ts.

of scandisk operations conducted sequentially; on 2 occasions there are four scans
running back to back as one sequence for four takes 12 minutes and the other 6
minutes! And as to how the system created the 1930’s entries remain a mystery to
this day, but is currently put down to hard disk corruption.

©

SA

NS

In

sti

tu

te

20

Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

45 of 57
© SANS Institute 2005

Author retains full rights

fu
ll r
igh
t
rr
eta
ins
5,
A

ut

ho

Item 53 – Last few days activity

©

SA
NS
I

ns

tit

ut

e2

00

Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

46 of 57
© SANS Institute 2005

Author retains full rights.

0
0
0
0
0
0
0
0
0

474 m.. -/-rwxrwxrwx 0
5799936
81920
491520
2

m..
m..
m..
..c

-/-rwxrwxrwx
-/-rwxrwxrwx
-/-rwxrwxrwx
-/-rwxrwxrwx

0
0
0
0

SA
NS
I

ns

tit

ut

e2

00

Tue Aug 17 2004 17:08:56
Key fingerprint = AF19 FA27 2F94 998D FDB5
(XAUPDA~1.HTM)
Tue Aug 17 2004 17:08:58
46472 m.. -/-rwxrwxrwx 0
46472 m.. -/-rwxrwxrwx 0
46472 ..c -/-rwxrwxrwx 0
(OPTIMI~1.EXE)
10 ..c -/-rwxrwxrwx 0
(XAUPDA~1.HTM)
2 m.. -/-rwxrwxrwx 0
(XAUPDA~1.HTM)
Tue Aug 17 2004 17:09:00
46472 m.. -/-rwxrwxrwx 0
(OPTIMI~1.EXE)
10 m.. -/-rwxrwxrwx 0
(XAUPDA~1.HTM)
Tue Aug 17 2004 17:09:04 4845004 ..c -/-rwxrwxrwx 0
4845004 ..c
-rwxrwxrwx 0
61 ..c -/-rwxrwxrwx 0
259198 ..c -/-rwxrwxrwx 0
4845004 ..c -/-rwxrwxrwx 0
Tue Aug 17 2004 17:09:06
61 m.. -/-rwxrwxrwx 0
Tue Aug 17 2004 17:09:08 4845004 m.. -/-rwxrwxrwx 0
4845004 m..
-rwxrwxrwx 0
4845004 m.. -/-rwxrwxrwx 0
Tue Aug 17 2004 17:09:14
259198 m.. -/-rwxrwxrwx 0
307200 ..c -/-rwxrwxrwx 0
4096 ..c d/drwxrwxrwx 0
Tue Aug 17 2004 17:09:16
307200 ..c -/-rwxrwxrwx 0
4096 m.. d/drwxrwxrwx 0
7233 m.. -/-rwxrwxrwx 0
Tue Aug 17 2004 17:09:44
70144 ..c -/-rwxrwxrwx 0
(UPDALL~1.EXE)
Tue Aug 17 2004 17:09:46
7904 m.. -/-rwxrwxrwx 0
70144 m.. -/-rwxrwxrwx 0
(UPDALL~1.EXE)
Tue Aug 17 2004 17:09:48
0 ..c -/-rwxrwxrwx 0
0 ..c
-rwxrwxrwx 0
0
..c
-rwxrwxrwx 0
Institute 2005
0 ..c -/-rwxrwxrwx 0
Tue Aug 17 2004 17:09:50
0 m..
-rwxrwxrwx 0
0 m..
-rwxrwxrwx 0

©

© SANS

fu
ll r
igh
t

0
0
0
0
0
0
0
0
0

3636869
3223057
2630625
2630553
2630553
2630553
2630625
2630553
3636880

c:\/WINDOWS/TASKS/SA.DAT
c:\/WINDOWS/SchedLog.Txt (SCHEDLOG.TXT)
c:\/WINDOWS/SYSBCKUP/rb005.cab (RB005.CAB)
c:\/WINDOWS/SYSBCKUP/rbtemp.cab (_BTEMP.CAB) (deleted)
<unknowndcfldd_hdd_sda1_dd-_BTEMP.CAB-dead-2630553>
<unknowndcfldd_hdd_sda1_dd-_BTEMP.CAB-dead-2630553>
c:\/WINDOWS/SYSBCKUP/rb005.cab (RB005.CAB)
c:\/WINDOWS/SYSBCKUP/rbtemp.cab (_BTEMP.CAB) (deleted)
c:\/WINDOWS/TASKS/Windows Critical Update Notification.job

0

3636880

c:\/WINDOWS/TASKS/Windows Critical Update Notification.job

0
0
0
0

4107654
1387398
25391366
49381539

c:\/WINDOWS/TEMPOR~1/CONTENT.IE5/index.dat (INDEX.DAT)
c:\/WINDOWS/COOKIES/index.dat (INDEX.DAT)
c:\/WINDOWS/HISTORY/HISTORY.IE5/index.dat (INDEX.DAT)
c:\/WINDOWS/TEMPOR~1/CONTENT.IE5/KPQTU5GV/xaupdate[1].htm

0
0
0

26286982 c:\/PROGRA~1/INTERN~2/UPDATE/optimize.exe (OPTIMIZE.EXE)
25421702 c:\/PROGRA~1/INTERN~2/optimize.exe (OPTIMIZE.EXE)
30378801 c:\/WINDOWS/TEMPOR~1/CONTENT.IE5/87HV26RX/optimize[1].exe

0

28408224 c:\/WINDOWS/TEMPOR~1/CONTENT.IE5/Y90FEDM5/xaupdate[1].htm

0

49381539 c:\/WINDOWS/TEMPOR~1/CONTENT.IE5/KPQTU5GV/xaupdate[1].htm

0

30378801 c:\/WINDOWS/TEMPOR~1/CONTENT.IE5/87HV26RX/optimize[1].exe

0

28408224 c:\/WINDOWS/TEMPOR~1/CONTENT.IE5/Y90FEDM5/xaupdate[1].htm

0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0

30360210
30360210
3223262
1188827
30360207
3223262
30360210
30360210
30360207
1188827
25422734
3147613
49471629
3147613
3222792
44392170

0
0

2704134 c:\/WINDOWS/APPLOG/APPLOG.ind (APPLOG.IND)
44392170 c:\/WINDOWS/TEMPOR~1/CONTENT.IE5/FHJGH453/updall2m[1].exe

rr
eta
ins

Tue Aug 17 2004 17:08:42
(WINDOW~1.JOB)
Tue Aug 17 2004 17:08:44
(WINDOW~1.JOB)
Tue Aug 17 2004 17:08:46

-/-r-xr-xr-x
-/-rwxrwxrwx
-/-rwxrwxrwx
-/-rwxrwxrwx
-rwxrwxrwx
-rwxrwxrwx
-/-rwxrwxrwx
-/-rwxrwxrwx
-/-rwxrwxrwx

ho

Tue Aug 17 2004 17:08:40

m..
m..
..c
..c
..c
m..
m..
m..
..c

ut

Tue Aug 17 2004 17:08:32

6
32711
1429974
1429974
1429974
1429974
1429974
1429974
474

5,
A

Tue Aug 17 2004 17:08:26

DE3D F8B5 06E4 A169 4E46

0
0
0
0
0
0

47 of 57
1188846
1188831
1188846
1188831
1188831
1188846

c:\/PROGRA~1/ZANGO/zango_kyf.dat.tmp (_ANGO_~1.TMP) (deleted)
<unknowndcfldd_hdd_sda1_dd-_ANGO_~1.TMP-dead-30360210>
c:\/WINDOWS/wininit.ini (WININIT.BAK)
c:\/WINDOWS/TEMP/ft22s.exe (FT22S.EXE)
c:\/PROGRA~1/ZANGO/zango_kyf.dat (ZANGO_~1.DAT)
c:\/WINDOWS/wininit.ini (WININIT.BAK)
c:\/PROGRA~1/ZANGO/zango_kyf.dat.tmp (_ANGO_~1.TMP) (deleted)
<unknowndcfldd_hdd_sda1_dd-_ANGO_~1.TMP-dead-30360210>
c:\/PROGRA~1/ZANGO/zango_kyf.dat (ZANGO_~1.DAT)
c:\/WINDOWS/TEMP/ft22s.exe (FT22S.EXE)
c:\/PROGRA~1/COMMON~1/JAVA/Xcpy1.cfg (XCPY1.CFG)
c:\/PROGRA~1/XML
c:\/PROGRA~1/XML/XML.dll (XML.DLL)
c:\/PROGRA~1/XML
c:\/WINDOWS/WIN.INI
c:\/WINDOWS/TEMPOR~1/CONTENT.IE5/FHJGH453/updall2m[1].exe

c:\/WINDOWS/TEMP/t9312.TMP (_9312.TMP) (deleted)
<unknowndcfldd_hdd_sda1_dd-_9311.TMP-dead-1188831>
<unknowndcfldd_hdd_sda1_dd-_9312.TMP-dead-1188846>
Author retains full rights.
c:\/WINDOWS/TEMP/t9311.TMP (_9311.TMP) (deleted)
<unknowndcfldd_hdd_sda1_dd-_9311.TMP-dead-1188831>
<unknowndcfldd_hdd_sda1_dd-_9312.TMP-dead-1188846>

fu
ll r
igh
t
rr
eta
ins
ho
ut
5,
A

©

SA
NS
I

ns

tit

ut

e2

00

Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

48 of 57
© SANS Institute 2005

Author retains full rights.

System ownership and why this happened
Having identified why the system was abandoned, the investigator turned his
attention to the other information that could be obtained from the system as to its
usage, the owner and the type of use the system was put to. Note this aspect of
the report is heavily sanitised.

ins

fu
ll r

igh
ts.

The first and main point of call when examining a windows system is the registry.
The registry in Windows 98 was quit embryonic when compared to the likes of
Windows XP, with its separate user logons, separate data storage area and even
separate software installs and permissions. When Microsoft was designing
Windows 98 they assumed the person sat in front of the system was authorised to
see and access all data. In modern IT Security terms it was a dedicated operating
system. As a result there is no ability to discern the particular users at any set time
other than by their actual activity and behaviour. There is no logon security on
Windows 98, the login process it simply for network shares and to prevent other
users seeing each others desktops (laughable as there was no file security from
preventing them from navigating to the files and desktop directory once ‘logged on’.

rr

eta

User activity on this system is split into several areas:
General Family type stuff – saving and printing digital pictures.
Playing computer games – ‘Worms’, ‘The Land before time’ and
‘Totally Spies’ (free from UK McDonalds during summer 2004)
c.
Using an instant messenger (zango)
d.
Watching films/DVDs (generally using the bundled bespoke software).
e.
Downloading files from peer-to-peer networks
(pornography
in the
form
of avi
andDE3D
mpg files
the peek
Key fingerprint
= AF19 FA27
2F94
998D
FDB5
F8B5–06E4
A169being
4E46 186mb
on one day)

20

05
,A

ut

ho

a.
b.

In

Many of the default and unnecessary icons were still on the desktop.
Many of the Spyware programs conducted a social engineering attack
and the user seems to have been duped into installing them. A
classic example being the Internet Optimizer itself a browser hijacker32
(see <http://www.2-spyware.com/browser-hijackers-removal>
The fact that they were connected to the internet via broadband and
using peer-to-peer software without either a personal firewall or
AntiVirus protection.

©

c.

SA

NS

a.
b.

sti

tu

te

The user was relatively new to computing and did not really understand much of
what was going on. For example:

By the 8th August 2004 they appear to have become annoyed with the popups their
Spyware was generating and they installed popup stopper. But given the number of
items of Spyware and the fact that many had been legitimately installed (having
duped the user), this had little chance of stopping the problem, furthermore, they
were only treating the symptoms and not the cause.

49 of 57
© SANS Institute 2005

Author retains full rights

fu
ll r

igh
ts.

Item 54 – The common user menu

Machine identification

rr

eta

ins

Looking at the [HKEY_Local_MACHINE] keys can reveal numerous parts of the
machines history, although on this occasion, the IP address is not recorded as it is
allocated on boot and Windows 98 had a notoriously flaky TCP/IP stack.

ho

Item 55 – IP Information from the Registry

In

sti

tu

te

20

05
,A

ut

[HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Class\NetTrans\000
0]
"DriverDesc"="TCP/IP"
"InfSection"="MSTCP.ndi"
"IPAddress"="0.0.0.0"
"IPMask"="0.0.0.0"
Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46
"DeviceVxDs"="vtdi.386,vip.386,vtcp.386,vdhcp.386,vnbt.386"
"InstallVnbt"="0"
"InfPath"="NETTRANS.INF"
"ProviderName"="Microsoft"
"DriverDate"=" 4-23-1999"
"DevLoader"="*ndis"
"NodeType"="1"

©

SA

NS

As was outlined earlier, the fact that the OS does not distinguish between users
means the likes of a types url list has little value, to the assessment but again does
shed light on the user’s activities:
Item 56 – URLs Typed into Internet Explorer

50 of 57
© SANS Institute 2005

Author retains full rights

fu
ll r

igh
ts.

[HKEY_USERS\.DEFAULT\Software\Microsoft\Internet Explorer\TypedURLs]
"url1"="Dial-Up Networking"
"url2"="http://www.hotmail.com/"
"url3"="http://www.udate.com/"
"url4"="http://www.bbc.co.uk"
"url5"="www.udate.com"
"url6"="http://www.nyrrc.org/"
"url7"="http://www.thetrainline.com/"
"url8"="http://www.trainline.com/"
"url9"="www.hotmail.com"
"url10"="http://www.bbc.co.uk/"
"url11"="http://www.cokemusic.com/"
"url12"="http://www.spele.nl"
"url13"="www.cokeumsic.com"
"url14"="http://www.ziplip.com/"
"url15"="http://www.lloydstsb.com/"
"url16"="http://www.mg-rover.co.uk/"
"url17"="http://www.yahoo.co.uk/"
"url18"="http://www.mgrover.co.uk/"
"url19"="http://www.amazon.co.uk/"
"url20"="http://www.play.com/"
"url21"=http://www.zonelabs.com/”

ho

rr

eta

ins

The only points that jump out from the above list are that the investigator hopes the
user didn’t use this system for online banking with Lloydstsb as several of the
Spyware and Trojans installed were capable of keystroke logging. And it is a
shame they didn’t stop longer at the Zonelabs site, even the free personal firewall
would have been useful.

05
,A

ut

The last command execute key in the registry can be useful if the user has actually
ruin some commands, but in this point and click age, few do. In this the key only
points to the ‘Worms Blast’ game that used to be installed.

20

Key fingerprint = AF19 FA27
2F94
998D
FDB5 DE3D
F8B5 06E4 A169 4E46
Item 57
– Last
Command
Executed

sti

tu

te

[HKEY_USERS\.DEFAULT\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU
]
"a"="\"C:\\WINDOWS\\Desktop\\Worms Blast.lnk\"\\1"
"MRUList"="a"

©

SA

NS

In

The Windows Media Player was the default player for wma and avi files, there was
a separate player installed for DivX files. The XXXX is where a pornographic file
name was removed by the investigator. Notice where these files came from, their
source directory would indicate they were downloaded via the peer-to-peer file
sharing program Grokster (http://www.grokster.com/).
Item 58 – Windows Media Player recent file list

[HKEY_USERS\.DEFAULT\Software\Microsoft\MediaPlayer\Player\RecentFileList]
"File0"="C:\\Program Files\\Grokster\\My Shared Folder\\Sam Cooke - Stand By Me
(Original).mp3"
"File1"="C:\\Program Files\\Grokster\\My Shared Folder\\Elvis Presley - I Did It My Way.mp3"
"File2"="C:\\Program Files\\Grokster\\My Shared Folder\\XXXX.mpg"
"File3"="C:\\Program Files\\Grokster\\My Shared Folder\\XXXX.wmv"
"File4"="C:\\Program Files\\Grokster\\My Shared Folder\\XXXX.wmv"
"File5"="C:\\Program Files\\Grokster\\My Shared Folder\\XXXX.asf"
"File6"="C:\\Program Files\\Grokster\\My Shared Folder\\XXXX.mpg"
"File7"="C:\\Program Files\\Grokster\\My Shared Folder\\XXXX.wmv"
"File8"="C:\\Program Files\\Grokster\\My Shared Folder\\XXXX.wmv"

51 of 57
© SANS Institute 2005

Author retains full rights

The username was initially hard to identify as the user did not use the bundled
Microsoft email client – outlook express. Instead they used the instant messenger
software installed. However, the registry came up trumps as the user completed a
registration process. (The exact name has been removed under the GIAC
conditions).
Item 59 – Identifying the Username

igh
ts.

[HKEY_USERS\.DEFAULT\Software\Ahead\Nero - Burning ROM\Info]
"Company"=""
"Serial5"="1502-4240-1125-0482-1088-9784"
"User"="GIAC-REMOVED"

fu
ll r

[HKEY_LOCAL_MACHINE\Network\Logon]
"username"=" GIAC-REMOVED "
"PrimaryProvider"="Microsoft Family Logon"

ins

[HKEY_USERS\.DEFAULT\Software\Macromedia\Shockwave\registration\lastname
]
@=" GIAC-REMOVED "

05
,A

ut

ho

rr

eta

If that hadn’t worked the cookies were the next stop. Oh and notice the dell cookie
on the 13 August 2004, it connects (time wise) to some images in the Internet
Explorer History directory they show Dell 2400 desktop system 33 – wonder if the
user was getting frustrated with their slow and dated operating system that was
creaking under all the additional program running. These were drawn together in a
search for all text files, as the investigator looked for logs etc, notice again how the
numbers of log files and other text files modified and created comes to a grinding
halt in 2 days.

©

SA

NS

In

sti

tu

te

20

Key fingerprint = AF19Item
FA27
DE3D found
F8B5 06E4 A169 4E46
602F94
– Text998D
files FDB5
and Cookies

There was only one IP address found in on the system in the live area, that of (the
X’s are for GIAC rules compliance) IP: 92.7X.1X5.X9, and this was drawn from a
GPRS software log. However, research on the internet revealed it to have been a
52 of 57
© SANS Institute 2005

Author retains full rights

restricted range indicating it to have been internal to the provider. It is been partially
removed as internal addresses of this kind are generally unique to the user and/or
provider.

igh
ts.

Item 61 – Attempting to locate the IP Address34

fu
ll r

Legal issues

eta

ins

The question as to whether the use conducted any illegal activity can be a difficult
one to answer as it can depend on many things. The pornography for example is
explicit but as to its breach of the Obscene Publications Act 1959 & 64 (OPA) the
investigator turned to the Internet Watch Foundation <www.ifw.org.uk> for advice.
On their site the OPA is defined as:

rr

Item 62 – Quote from the Internet Watch Foundation35

ut

ho

Obscene Publications Act 1959 & 1964

<http://www.iwf.org.uk/police/page.22.38.htm>

In

sti

tu

te

20

05
,A

The law on obscene publications is difficult to define in everyday terms.
As a guide it could include images featuring acts of extreme sexual activity such as bestiality,
necrophilia, rape or torture.
Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46
This act makes it an offence to publish, whether for gain or not, any article whose effect, taken
as a whole, is such, in the view of the court, to tend to "deprave and corrupt" those likely to
read, see or hear the matter contained or embodied in it.

©

SA

NS

Although the names of the pornography video files did include on several occasions
the words rape, the belief is that many are either ‘staged’ or simply advertising tricks
to increase hits. Note – this was professional advice obtained by the investigator
from persons employed in these types of investigations. Apparently, this is a
common renaming trick used by site owners to increase the size of their libraries
and to maintain customer interest. Detailed analysis of these files was not
performed.
There were also 30 music files and music videos, mainly of Elvis. They type and
quality of these indicates they were originally released by one of the major recording
labels. Their presence on the hard disk itself in not sufficient to prove they were
illegally obtained however, they are in two locations:
C:\My Shared

53 of 57
© SANS Institute 2005

Author retains full rights

C:\Program Files\Grokster\My Shared Folder

With online music purchasing increasing exponentially in the UK, the user may
have an external device or other system where they legally acquire the files.
However, it is the belief of the investigator that given the other files in these folders
(ie pornography) which are unlikely to be ‘purchased’ these music videos were also
downloaded via the peer-to-peer software especially as there were 4 different types
of peer-to-peer applications.

fu
ll r

Unused, slack and unallocated space searches

igh
ts.

Therefore, a breach of the recording labels licence’s and IPR has occurred.
However, this is currently a topical subject both in the USA and Europe with USA
based companies using USA legislation against non US citizens outside the US
and as such, the acceptable levels and applicability of these laws and procedures
have yet to be determined.

ins

By searching the unallocated parts of the disk, the following information was
obtained (the process is described but all detail is excluded under GIAC rules :

ho

rr

eta

Telephone number: By searching for the area code of the city where the
refuse facility is located a 1337 entries were found, these piped into more
were scanned visually in 30 seconds and the partial number was then used
as the basis for another search, this time revealing the complete number.

05
,A

ut

House Number, postal address and post code: Right next to one of the
telephone numbers cashed from a web form.

20

user’s=name:
Nero2F94
Registration
andDE3D
confirmed
by theA169
1300+
other
KeyMain
fingerprint
AF19 FA27
998D FDB5
F8B5 06E4
4E46
instances in cookies, text files, logs and web cache.

tu

te

Email address: Easy when you have a name, search for the it near an ‘@’.

NS

In

sti

Other contacts know by main user: Several in Outlook Express identity files
( C;\windows\Application Data\Identities\{7D345F00-559211D8-B270-90928CAF6A4C}\Microsoft\Outlook Express)

SA

Summary of events and supposition by the investigator

©

The following is the summary of the events; the system was built in February 2004,
with Windows 98 OSR2. It was used mainly by one individual, probably male who
occasionally allowed others to access games or the internet. The user was not
security orientated or particularly computer literate as much of the problem
stemmed from the lack of basic internet security devices ie a Firewall and AntiVirus
(although from this investigation not even Norton could have helped him). The user
elected to install several ‘free’ internet accelerators and dubious software touting to
be popup stoppers etc.
The installation of several peer-to-peer program facilitated the increase in
54 of 57
© SANS Institute 2005

Author retains full rights

downloaded software of dubious sources and the volume of pornography installed
on the system hints to broadband being installed – there is a reference to NTL
broadband medic in the unallocated space but much of this data is corrupt. The
user seems to have become aware of the Spyware as a popup blocker is installed
and a few weeks later the installation of Spyware-blocker is seemingly started,
however possibly due to so many files being infected and corrupted or hardware
failure, the system crashed during the install and despite attempts over several days
the system is never again operational.

igh
ts.

It was noted that the user had considered purchasing a new machine as several
references to Dell <www.dell.co.uk> were seen in the cache and the Internet
Explorer history points to the commencement or at least pricing of a Dell
Dimension 2400.

rr
ho

Conclusions and points learnt

eta

ins

fu
ll r

When the system finally fails to boot on 22 August 2004 the user makes the
decision to dispose of it. They remove the memory and, judging by the software
and media players installed (one from X-Men2 and Nero Burning ROM), a
DVDR/CDRW 51/2” device (see the images at the start). Then either believing that
no data can be recovered or not knowing about data forensics, the case is then
dumped at the local refuse facility, where the investigator spots it the next day.

te

20

05
,A

ut

The failure of the hard disk – either its hardware or its logical structure did present
significant problems for the forensic investigator. Furthermore, using a system
obtained in this manner was a risk, as the disk may have been completely clean,
well maintained ie with little meat for the report or loaded with child pornography or
images
of that nature.
The
last 2F94
of these
resulted
in both
the4E46
loss of not
Key fingerprint
= AF19
FA27
998Dcould
FDB5have
DE3D
F8B5 06E4
A169
only the subject material but also the seizure of all equipment used by the
investigator to the point where the content was discovered.

NS

In

sti

tu

As it was, the system proved to be a even more of a challenge than originally
expected as the numerous items of Malware, the failing structure and 23 scandisk
executions all added to the tangled web of corrupt data and misleading facts. The
fact that the BIOS clock was significantly out of sync with GMT also didn’t help.

©

SA

This system was an easy target for Malware and viruses as it had everything going
for it; no antivirus software, no firewall, numerous peer-to-peer applications and
several browser hijacking programs (and an uneducated user). The system lasted
just under 9 months but given the sites and user activity it did well to last that long,
especially as much of the problem was user installed under a social engineering
attack aimed to trick them to thinking they would fit their problems.
Personal Statement:
I was honestly saddened by the death of this system, a strange but true comment. I
believe that over the course of the investigation I have gotten to know this system
well, as I discovered its habits and foibles. The process of investigating the reason
55 of 57
© SANS Institute 2005

Author retains full rights

for its disposal was an interesting journey that had me slowly piece the gruesome
facts about the demise of this operating system. I was horrified when I approached
the time line entries for 17 August 2004 as they pointed to the scandisk logs that in
simple black and white showed how the system had not managed to reboot and
correct itself despite numerous attempts – like watching someone drowning I
suppose. Ironically, the fatal blow seems to have come from a piece of software
designed to remove and protect the system from the numerous items of Spyware
and Trojans that it housed.
Review of Investigation Objectives

Last booted / shutdown (date and
time)

rr

eta

User Objectives – (Identify)
The common and or last user
Owner (physical and email
addresses)
IP Address of the last user

Static IP not printed in clear
in this report

Completed
Yes
Yes
No

Yes

Completed
Yes
Yes (not
included in this
report)
Yes

ut

U3

HDD Errors prevented any
meaningful data being
extracted
Several versions obtained,
almost depends on what is
called a boot and what makes
a shutdown
Comments
Not printed in this report
Not printed in this report

ho

Number
U1
U2

igh
ts.

S4

Comments

fu
ll r

System Objectives – (Identify)
Operating System
Current OS
Previous OS

ins

Number
S1
S2
S3

End of Part 2

©

SA

NS

In

sti

tu

te

20

05
,A

U4
General User activity
Yes
Number
Hidden software Objectives
Comments
Completed
H1
Locate and identify any Viruses
Numerous identified with
Yes
Key
AF19
FA27
998D FDB5
DE3D
F8B5
06E4
A169 4E46 Yes
several
scans
using
different
H2 fingerprint
Locate =and
identify
any2F94
Spyware
products
H3
Locate and identify any Malware
Yes
H4
Locate and identify any Trojans
Yes
Number
Legal Objectives
Comments
Completed
L1
Identify any illegal activity
Some pornography of dubious
Yes
subjects. None (thankfully)
child orientated
L2
Identify any illegal software
Some pirated wma and avi
Yes
files

56 of 57
© SANS Institute 2005

Author retains full rights

Table of Items (tables, command outputs and screen captures)

©

SA

NS

In

sti

tu

te

20

05
,A

ut

ho

rr

eta

ins

fu
ll r

igh
ts.

Item 1 – Identification details for recovered Floppy Disk
Item 2 – Label details for the Master Working Disk (image)
Item 3 – file (Linux) Command Output of v1_5.gz
Item 4 – md5 (Linux) Command Output of v1_5.gz
Item 5 – fsum (Windows) Command Output of v1_5.gz
Item 6 – Screenshot of Norton AV (Windows) Completing Scan of v1_5.gz
Item 7 – Initial file browsing with Autopsy
Item 8 – Autopsy output of visible file on target disk
Item 9 – Timeline for Floppy Disk
Item 10 – List of 'live' files on the floppy disk
Item 11 – File ownership details
Item 12 – Screenshot of the Camouflage Website
Item 13 – fsum (Windows) Command output of Camou121.exe
Item 14 – WinZip (Windows) contents of Camou121.exe selfextracting zip file
Item 15 – dir (Windows) Command output of Camouflage folder post install
Item 16 – fsum (Windows) for files created by the Camouflage install process
Item 17 – Camouflage right click menu
Item 18 – Settings GUI window for the Camouflage program
Item 19 – Password request GUI
Item 20 – Camouflage Window - contents of Password_Policy.doc carrier file
Item 21 – Camouflage Window - contents of Remort_Access_Policy.doc
Item 22 – Table of CAB.mdb extracted from Remote_Access_Policy.doc
Item 23 – fsum (windows) of all files recovered from Camouflage carrier files
Item 24 – List of all files (inc those hidden) found of the floppy disk
Item 25 – Screenshot of hashes not matching
ItemKey
26 fingerprint
– Quote from
Ballard
InformationSensivity
= AF19
FA27Ind
2F94
998D FDB5 DE3D Policy
F8B5 06E4 A169 4E46
Item 27 – Tools Used Matrix
Item 28 – Pictures of the outside of the system
Item 29 – Pictures of the inside of the system
Item 30 – BIOS Timings taken at 1733 hours on 31 August 2004
Item 31 – The external IDE caddie with the abandoned drive fitted
Item 32 – External Caddie OS Patch
Item 33 – Quote on NFTS write support
Item 34 – Legal defence for Theft
Item 35 – Imaging in progress
Item 36 – Output from the file command
Item 37 – Quote from Microsoft explaining the HDD ID Tag
Item 38 – First look at the imaged file structure
Item 39 – Initial look at file ownership and their associated creation times/dates
Item 40 – Windows version extracted from the shell
Item 41 – Possibly the last use of the system
Item 42 – Cutting from System Time Line
Item 43 – Summary of the scandisk.log for the system
Item 44 – MAC for the boot.log
Item 45 – Mounting the Image in Read Only mode
Item 46 – Diagram of the Network used

4
5
5
6
6
6
7
7
9
10
10
11
11
12
12
13
13
14
14
15
15
15
16
18
19
21
22
23
24
25
25
26
26
27
28
28
29
29
30
30
33
34
35
36
37
38

57 of 57
© SANS Institute 2005

Author retains full rights

38
39
39
39
40
41
43
47
47
47
48
48
49
49
50
50

References

eta

(In the order in which they appear in the document)

ins

fu
ll r

igh
ts.

Item 47 – Norton Anti Virus Discovered Trojan
Item 48 – Creation and modification MACs for ‘POLMX2.CAB’ Trojan
Item 49 – AVG Scan Results
Item 50 – Spyware found by Spyware Doctor on the HDD
Item 51 – TrendMicro details on TROJ_RVP.D Trojan
Item 52 – Installation report for Sypblocker
Item 53 – Last few days activity
Item 54 – The common user menu
Item 55 – IP Information from the Registry
Item 56 – URLs Typed into Internet Explorer
Item 57 – Last Command Executed
Item 58 – Windows Media Player recent file list
Item 59 – Identifying the Username
Item 60 – Text files and Cookies found
Item 61 – Attempting to locate the IP Address
Item 62 – Quote from the Internet Watch Foundation

“GIAC Certified Forensics Analyst (GCFA)” GIAC Web Site – Individual Subject
Certifications SANS 12 Jan 2005
< http://www.giac.org/subject_certs.php#gcfa>

2

“Fedora Core 2” Open Source Operating System. Operating System used for the
forensics workstation. 12 Jan 05 <http://fedora.redhat.com/>

3

Key fingerprint
= AF19
FA27
2F94 998D
FDB5Kit
DE3D
A169
4E46
“Autopsy
Forensic
Browser
Overview”
Sleuth
WebF8B5
Site.06E4
12 Jan
2005
<http://www.sleuthkit.org/autopsy/>

4

“The Sleuth Kit Overview” The Sleuth Kit Web Site. 12 Jan 2005
<http://www.sleuthkit.org/sleuthkit/index.php>

5

“Microsoft XP Professional” Windows XP Operating System. Microsoft 12 Jan
2005 <http://www.microsoft.com/windowsxp/pro/evaluation/default.mspx>

6

“Norton AntiVirus” Norton Anti Virus Software 12 Jan 2005
<http://www.symantec.com/nav/nav_9xnt/>

7

“The Coroners Tool Kit” The Coroners Tool Kit Web Site. Forensic software
written by Dan Farmer and Wietse Venema 12 Jan 2005
<http://www.porcupine.org/forensics/tct.html>

8

“Overview of Fsum” Fast Data Integrity Checker. SlavaSoft Inc Web site. 12 Jan
2005 <http://www.slavasoft.com/fsum/overview.htm >

9

“Camouflage Home Page” Hide Your Files. 12 Jan 2005
<http://camouflage.unfiction.com/>

©

SA

NS

In

sti

tu

te

20

05
,A

ut

ho

rr

1

58 of 57
© SANS Institute 2005

Author retains full rights

“WinZip” The Zip file utility for Windows. WinZip Computing 12 Jan 2005
<http://www.winzip.com>

11

“Microsoft Access” A Powerful Database Solution. Microsoft 12 Jan 2005
<http://office.microsoft.com/en-gb/FX010857911033.aspx>

12

“Overview of Camouflage” Camouflage – Hide Your Files. 12 Jan 2005
<http://camouflage.unfiction.com/Overview.html>

13

“Search Orders” Power of Officials to Enter Your Home – The Liberty guide to
]Human Rights. 12 Jan 2005 <http://www.yourrights.org.uk/yourrights/chapters/the-right-to-privacy/power-of-officials-to-enter-yourhome/search_orders.shtml>

14

Home Page for EPICPC. The main Web site of the company that trade under the
name ‘EPIC Computers’ . 12 Jan 2005 < www.epicpc.co.uk>

15

“[PATCH] USB storage: patch for unusual_devs.h” Summary of changes from
v2.6.0 to v2.6.1. Author <Alexander<at>all-2.com> published by
LinuxHQ.com 5 Jul 2004 / 12 Jan 2005
<http://www.linuxhq.com/kernel/changelog/v2.6/1/>

16

“NTFS Documentation – Chapter 3 Linux and NTFS” NTFS FAQ. The LinuxNTFS Project Team 12 Jan 2005 <http://linuxntfs.sourceforge.net/info/ntfs.html#3.0>

17

“Sections 1 – 6 of Theft Act 1968 Explained” Theft Act 1968. A production of the
UK Theft Act 1968 (online version not available from HM Government source)
Poole: The Bournemouth and Poole College. 12 Jan 2005
Key<http://www.sixthform.info/law/01_modules/mod5/14_1_theft.htm>.
fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

20

05
,A

ut

ho

rr

eta

ins

fu
ll r

igh
ts.

10

18

In

sti

tu

te

“The Linux command ‘dfcldd’” Written by the Defense Computer Forensics Lab
12
Jan 2005 <http://www.dcfl.gov/dcfl/dcfl.htm> available from
<http://sourceforge.net/project/showfiles.php?group_id=46038>
“Boot Sectors on MBR Disks” XP Resource Kit – Troubleshooting. Microsoft. 12
Jan 2005 <http://www.microsoft.com/resources/documentation/Windows/XP
/all/reskit/en-us/Default.asp?url=/resources/documentation/Windows/XP/
all/reskit/en-us/prkd_tro_ilxl.asp>.

20

“Windows 98” Windows 98 Operating System. Microsoft 12 Jan 2005
<http://www.microsoft.com/windows98/default.asp>

21

“Kazaa Lite” Music and Movis Download Site. Parent Company: MP3
Diamond/IPC Solution 12 Jan 2005 <http://www.kazaalite.nl/en/>

22

“Kazaa Lite K++” Music and Movis Download Site. Parent Company: K-Litetk/IPC
Solution 12 Jan 2005 <http://www.kl-kpp.net/>

©

SA

NS

19

59 of 57
© SANS Institute 2005

Author retains full rights

“Grokster” Next Generation File Sharing. Grokster Web Site. 12 Jan 2005
<http://www.grokster.com/>

24

“MorpheusUltra” Peer to Peer file Sharing. MorpheusUltra Web site. 12 Jan 2005
<http://www.morpheusultra.com>

25

“dc-12-buranii dinvid-1-lg.jpg” by [uranii]invid. Submitted Artwork for Defcon 12.
Seen as the desktop background in Item 35 and 45. Published by
Defcon.org 12 Jan 2005 <http://www.defcon.org/html/defcon-12/dc-12-art/dc12-art-8.html>

26

“Smoothwall Firewall” The Smoothwall Open Source Project. The Smoothwall
Project Team 12 Jan 2005 <http://www.smoothwall.org>

27

“Friendly Net Viewer General Info” Friendly Net Viewer Product Information.
A.Kilevich & Co 12 Jan 2005 <http://www.kilievich.com/fviewer/>
(used to make the image)

28

“Free AVG Virus Scanner” The AVG Free Edition. 12 Jan 2005
< http://free.grisoft.com/freeweb.php/doc/2/>

29

“Spyware Doctor” PC Tools Software Web Site
<http://www.pctools.com/spyware-doctor>

30

“Technical Details for TROJ_RVP.D” Virus Encyclopaedia. TrendMicro 12 Jan
2005 <http://www.trendmicro.com/vinfo/virusencyclo/default5.asp?
VName=TROJ_RVP.D>

ins

fu
ll r

igh
ts.

23

“Installation Report” Product Information. Spyblocker-software 12 Jan 2005
http://www.spyblocker-software.com/spyblocker/instrpt.htm>
Key<fingerprint
= AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

20

31

05
,A

ut

ho

rr

eta

PC Tools 12 Jan 2005

“Browser Hijacker Description” How to remove Browser Hijackers parasites from
computer? 12 Jan 2005 <http://www.2-spyware.com/browser-hijackersremoval>.

33

Dell Computer Corporation Web Site. Dell Computer Corporation 12 Jan 2005
<http://www1.euro.dell.com/content/products/features
.aspx/dimen_2400?c=uk&cs=ukdhs1&l=en&s=dhs>

34

“The Online Sam Spade Tools” Sam Spade Web Site. 12 Jan 2005
<http://www.samspade.org> (tool used to obtain information and pictured)

SA

NS

In

sti

tu

te

32

35

©

“Obscene Publications Act 1959 & 1964” The Laws. Internet Watch Foundation.
12
Jan 2005 <http://www.iwf.org.uk/police/page.22.38.htm>

60 of 57
© SANS Institute 2005

Author retains full rights


Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

1 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

2 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

3 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

4 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

5 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

6 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

7 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

8 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

9 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

10 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

11 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

12 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

13 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

14 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

15 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

16 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

17 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

18 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

19 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

20 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

21 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

22 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

23 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

24 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

25 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

26 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

27 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

28 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

29 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

30 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

31 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

32 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

33 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

34 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

35 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

36 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

37 of 38

18/03/2022, 12:46

Firefox

https://online.ﬂiphtml5.com/rllbc/zdmn/

38 of 38

18/03/2022, 12:46


