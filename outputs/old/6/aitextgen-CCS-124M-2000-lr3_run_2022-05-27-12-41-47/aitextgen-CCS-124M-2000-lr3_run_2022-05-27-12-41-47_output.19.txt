Log entry found: Firewall (Type: Firewall) blocked. [Blocked network traffic protocol........................................................................ings more than one rest room facilities, even the provider of
paperwork, main suspect or a techniques in which computer data, which
samba parts of the data are stored, when it is used on a computer hard drive, when the
investigating a web browser.

11:46:08 to
w:46:24

58 of 57
© SANS Institute 2005

Author retains full rights

fu
ll r

The purpose of the samba share was to allow the use of windows based tools (with
which the investigator was more familiar). Upon connecting to the read only
network share, a complete copy of the contents was taken to a temporary directory
E:\GIAC SANS TEMP\. This was in case any of the Trojan hunting software tried
to remove or alter the data. Although the data was safe, AntiVirus and Anti Malware
software have a bad habit of freezing when they attempted to delete data that was
prohibited by more than the system’s own file permissions. Note as standard
practice, all products were updated moments before being used on the target
image.
40 of 57
© SANS Institute 2005

Author retains full rights

AntiVirus, Trojan and Malware Scans
The investigator recognised that the fact that only complete files were visible and
that any viruses etc held in slack or unused space would not be found by searching
through samba shared data, he believed there would be sufficient to be going on,
furthermore, a full slack and deleted file search would be conducted on the host
Linux system.

igh
ts.

The first a Virus Scan was performed using Norton Anti Virus a good produce that
the investigator is familiar with, it is configurable and it will detect Trojans, Viruses,
Worms and {as we will see only some} Malware. On this occasion it revealed one
virus called ‘polmx2.cab’ which it classed as a Trojan.

ho

rr

eta

ins

fu
ll r

Item 47 – Norton Anti Virus Discovered Trojan

05
,A

ut

A check of the complete timeline revealed the Trojan was created on the disk and
modified on the times shown below:
Item 48 – Creation and modification MACs for ‘POLMX2.CAB’ Trojan

Key fingerprint = AF19
2F94 998D
DE3Dc:\/WINDOWS/TEMP/polmx2.cab
F8B5 06E4
4c:\/WINDOWS/polmx2.cab
F8B5 06E4
4c:\/WINDOWS/TEMP/polmx2.cab
F8B5 06E4
4c:\/WINDOWS/TEMP/polmx2.cab
F8B5 06E4
4c:\/WINDOWS/TEMP/polmx2.cab
F8B5 06E4
268/polmx2.INF
268_ARMS
Output
Volume Serial Number is 70A1-3272

sti

tu

te

20

Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

©

SA

NS

In

The time line shows that just 5 minutes later the user attempted to install a
defensive piece of software in the form of ‘Spyblocker’ from <www.spyblockersoftware.com>, this can be seen from the time line entries coloured blue, that
relate to the installation and modification of 6 files, as referred to in the installation
report on the company’s web site31:
Item 52 – Installation report for Sypblocker

43 of 57
© SANS Institute 2005

Author retains full rights

http://www.spyblocker-software.com/spyblocker/instrpt.htm>
Installation Report: GP-Install
Generated by Ininformation

80

“spyblocker than 1011 MB”spy file

fu
ll r

igh
ts.

As will be explained in the next section, when a carrier file was modified to
include a different file, the modification time was set; when the carrier file
modification.exe was obtained from the site manage, Coalfire was able to seen the time line entries
====================
Log entry found: Firewall (Type: Firewall) blocked. [Blocked network traffic protocol................................................................................ated image from the purpose of the report, an
attacker would more than hint to aigh
evidence

te

20

The function test of the remaining system complete it was sealed and stored in the
locker of the garage. Meanwhile the HDD was prepared for imaging. The
Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46
photograph below shows the hard disk installed in an external caddie ready to be
connected to the Forensic Laptop (under it).

©

SA

NS

In

sti

Item 31 – The external IDE caddie with the abandoned drive fitted

25 of 57
© SANS Institute 2005

Author retains full rights

Forensic Laptop Specification

igh
ts.

The forensic Laptop used for this examination was a Dell Inspiron 5100. The
specification of the laptop being; Intel Pentium 4 2800 MHz with 768Mb RAM, a
CDR/RW and 3com on board network card. The graphics processor was a 64 mb
Mobile ATI card with a 1024x768 TFT screen. It boasts a IEEE 1394 port as well as
2 x USB 2 ports. This laptop has more than proven itself in the past and the
performance of each of the components has been well above standard without the
need for specialist drivers. It will accept over 15 different distributions of Linux and
has run Windows from 95 – 2003 Enterprise Server. As the caddie cost in the
region of £30) the Main Forensic OS was a free distribution(FC2) and the
laptop (inc 2 extra HDD and internal caddie drives) cost £550 (~$1030) the whole
forensic outfit was comparatively cheep £580 ($1085).

eta

ins

fu
ll r

The only glitch that was presented was with the use of the external caddie which
connects IDE devices to either IEEE 1394 or USB2. While MS Windows was able
to address the device, Fedora Core 2 did not have any support for it in the kernel.
That said some research on the internet did reveal a patch had been submitted (see
below) which when applied allowed the external caddie to be mounted in the
Fedora Core 2 (FC2) OS in read only mode.

rr

Item 32 – External Caddie OS Patch 15

ho

<alexander@all-2.com>
[PATCH] USB storage: patch for unusual_devs.h

05
,A

ut

I send a patch and copy of /proc/bus/usb/devices for my 5`25 external
USB enclosure. I don know exactly manufacturer of this device, but
model is CD-509.
It will be nice if it helps somebody else.
http://www.linuxhq.com/kernel/changelog/v2.6/1/

20

Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

In

sti

tu

te

Note Write support for NTFS is very limited see cutting below from the Linux-NTFS
sourceforge.net web web web web site16.
Item 33 – Quote on NFTS write support

NS

3.2 Can the Driver write to an NTFS volume, too? 12 Jan 2005 <http://linuxhq.com/kernel/showfs.php#gcfa>

©

SA

Not really, but if you only need to copy files from Linux to Windows on a dual-boot
machine, see "How to write to NTFS" below for a possible way to work around the lack of
write support. For write support in Linux, read on.
There are two drivers, currently. The original driver, in 2.4 has some write code in it, but it is
extremely dangerous to use it. The possibility of destroying your filesystem is very high.

Legal Implications of using the abandoned computer
Given the circumstances under which the system was abandoned, the investigator turned his
attention to the software.
Section 5 of the Theft Act 1968 provides a legal defence to the finder of items of
property that the owner has abandoned:
Item 34 – Legal defence for Theft

5. Belonging to another
(1)
====================
Log entry found: Firewall (Type: Firewall) blocked. [Blocked network traffic protocol................................................................................ally these analysed images were
downloaded via the peer-to-peer software especially as there were 4 different types
of peer-to-peer applications.

fu
ll r

The HDD removed the images must be considered as a movable object, to which all
 rules for tangible thefu should be undertaken.
The battery was then tried on the other potential carrier file but it not
accepted that the owner has abandoned his rights of ownership of
the property.

eta

ins

The second part of the practical required the analysis of a system that had been
compromised in a FA27 external
mounted room. The second part of the practical required the analysis of a floppy disk from a Robert John Leszczynski’s
briefcase, which was developed as a digital forensics report, when an examiner was
 factors, it is believed, brought a bit-for-bit, verified
copy/Camouflage
, and thepasswording of the storage media. The conclusion being that they were not able to be used on windows NT
or if they had been present, they will be possibility of stopping30378801 to those videos.
The first and main point of call when a suspect were to identify and explain which in which Mr RJ
~1.Once the suspect had identified the relevant documents the forensic analyst was18
32 of 57
© SANS Institute 2005

Author retains full rights

rr

eta

ins

fu
ll r

When the forensic analyst has identified the necessary evidence the forensic analyst was specialised in that case. They will most
probably focus the answer as to what level of examination should be undertaken to
read, as justice should be seen in the case management system.
When the suspect has identified the relevant documents the forensic analyst should be considered in
selecting the evidence and(rreta) which are unlikely to be ‘purchased’ these music videos were also
downloaded via the peer-to-peer software especially as there were 4 different types
of peer-to-peer applications.
fu
ll r

Unused, slack and unallocated space searches

igh
ts.

Therefore, a breach of the’s and IPR has occurred.
However, this is currently a topical subject both in the USA and Europe with USA
based companies using USA legislation against non US citizens outside the US
and as such, the acceptable levels and applicability of these laws and procedures
have yet to be determined.
ins

By searching the unallocated parts of the disk, following information was
obtained (the process is described but all detail is excluded under GIAC rules :

ho

rr

eta

Telephone number: By searching for the area code of the city where the
refuse facility is located a 1337 entries were found, these piped into more
were scanned visually in 30 seconds and the partial number was then used
as the basis for all other persons within the laboratory.
However, the complete picture below shows the complete number.

05
,A

ut

ho

The second part of the practical required the analysis of a system that had been
compromised in a cold environment) by a prosecutor or judge, who conduct the investigation as best they can with shifting
priorities and reducing resources.

eta

ins

The only glitch that was presented was with the use of a system that had been
compromised in a cold environment)DVDsums.
Tue Aug 17 2004 17:08:

05
,A

ut

ho

The download link was followed and the self-expanding-executable-zipped file
Camou121.exe was obtained and hashed.

Item 13 – fsum (Windows) Command output of Camou121.exe

In

sti

tu

te
20

fsum
–md5
Camou121.exe
Key fingerprint
= AF19
FA27
2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46
Command
;
SlavaSoft
Optimizing
Checksum Utility fsum 2.0
Output

te

20

Thefsum Utility fsum 2.0
Output

The 22st line of text on both screen shots shows the date stamp 2014.07.25 while Investigator 2.5.
“Microsoft XP Professional” Windows XP Operating System. Microsoft 12 Jan 2005
<http://
====================
Log entry found: Firewall (Type: Firewall) blocked. [Blocked network traffic protocol................................................................................ER
Appendix C – Acquisition Process Flow Chart...............................................................................
Appendix D - Processing Flow Chart............................................................................
Appendix E - Analysis Flow Chart................................................................................. 70
Appendix F - Presentation Flow Chart.......................................................................... 71
Appendix G - Chain of custody record............................................................................ 2
Appendix H - Image Acquisition Worksheet................................................................................. 75
Appendix I – Digital Forensics Analysis Form / Spreadsheet........................................ 79
Appendix J – Digital Forensics Report Template........................................................................... 81

4

Abbreviations
AFF

Advanced Forensic Format

ATA

20

Comman ls –sl > /root/fileownershipdetails.txt

d

tu

te

20

Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

Output

SA

NS

In

sti

tu

te

20

Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46

©

The purpose of the samba share was to allow the use of windows based tools (with
which the investigator was more familiar). Upon connecting to the read only
network share, a complete copy of the contents was taken to a temporary directory
E:\GIAC SANS TEMP\. This was to allow the investigator see for a first time the directory structure.
Additionally, as both the mount command and the Linux file permissions were set to
read-only, browsing could be undertaken without fear of altering the data.

05
,A

ut

ho

The data on the following Forensic Note Summary pages are on the following page:
Item Summary –could show a file of the first user

Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4

do not hide entries starting with.
print octal escapes for non graphic characters
use a long list format but do not list group

©

SA

-a
-b
-o
information

NS

In

sti

tu

te

A cursory examination of this the root of the system, would confirm the file
identification of the early personal edition of Windows. Files like the
autoexec.bat and config.sys are not used on windows NT NT NT (any version) and
the FAT32 file structure) are not readable by NT. In order that we might learn the
install date of the operating system the ls command was executed with the ‘ -abo ’
switches. These have the effect of displaying (taken from the ls manual):
This produced the following output:
Item 39 – Summary of the scandisk.log for the system

Unknowndcfldd_hdd_sda1_dd: x86 boot sector, code
offset0x58, OEM-ID ’ which the
report_dd: x86 boot sector, sectors/cluster 8, Media
descriptor 0xf8, heads 255, hidden sectors 63, sectors 63, sectors
12659157 (volumes > 32 MB), FAT (32 bit), sectors/FAT
12342, reserved3 0x800000, serial number 0x1c12160a,
unlabeled
A look at the Microsoft web site19 decoded the MSWIN4.1 as:
28 of 57
© SANS Institute 2005

Author retains full rights
Item 37 – Quote from Microsoft explaining the HDD ID Tag

You might also see the OEM ID "MSWIN4.0" on disks formatted by
Windows 95 and "MSWIN4.0" on disks formatted by Windows 95 OEM
Service Release 2 (OSR2), Windows 7, and and XP
Professional does not use the OEM ID field in the boot sector except for
verifying NTFS volumes.

igh
ts.

Therefore, it is assumed that the hard disk was formatted with either Windows 95
(OSR2), Windows ME, and Windows. Whilst it is not impossible for this to be a
production/Forensic/floppy/en&s.

ins

fu
ll r

With the image marked in the Linux file permissions, the following activities are
checked by the Linux file.1 an md5 hash
4E46/IP9
====================
Log entry found: Firewall (Type: Firewall) blocked. [Blocked network traffic protocol........................................................................36

Appendix C - Acquisition Process Flow Chart............................................................................... 68



Coalfire considered the read only samba shared, complete copy of the contents of the abandoned system.



ins

fu
ll r

The HDD removed it was catalogued as:

05
,A

ut

ho

The Forensic Workstation

20

Key fingerprint = AF19 FA27 2F94 998D FDB5 DE3D F8B5 06E4 A169 4E46



The purpose of the samba share was to allow the use of windows based tools (with
which the investigator was more familiar). Upon connecting to the read only
network share, a complete copy of the contents was taken to a temporary directory
E:\GIAC SANS TEMP\. This was to allow the use of windows based tools (with
which the investigator was more familiar). Upon connecting to the read only
network share, a complete copy of the contents was taken to a temporary directory
E:\GIAC SANS TEMP\.\. This was in case any of the Trojan hunting software tried
to remove or alter the data. Although the data was safe, AntiVirus and Anti Malware
software have a bad habit of freezing when they attempted to delete data that was
prohibited by more than the system’s own file permissions. Note as standard
practice, all products were updated moments before being used on the target
image.
40 of 57
© SANS Institute 2005

Author retains full rights

AntiVirus, Trojan and Malware Scans
The investigator recognised that the fact that only complete files were visible and
that any viruses etc held in slack or unused space would not be found by searching
through samba shared data, he believed there would be sufficient to be going on,
furthermore, a full slack and deleted file search would be conducted on the host
Linux system.

igh
ts.

The first a Virus Scan was performed using Norton Anti Virus a good produce that
the investigator is familiar with, it is configurable and it will detect Trojans, Viruses,
Worms and {as we will see only some} Malware. On this occasion it revealed one
virus called ‘polmx2.cab’ which it classed as a Trojan.

ho

rr

eta

ins

fu
ll r

Item 47 – Norton Anti Virus Discovered Trojan

05
,A

ut

A check of the complete timeline revealed the Trojan was created on the disk and
modified on the times shown below:
Item 48 – Creation and modification MACs for ‘POLMX2.CAB’ Trojan

Key fingerprint = AF19
2F94 998D
DE3Dc:\/WINDOWS/TEMP/polmx2.cab
F8B5 06E4
4 06E4rwx 0
0 0F94 998D
FDB5 DE3Dc:\/WINDOWS/TEMP/polmx2.cab
F8B5 06E4
4E46(POLMX2.CAB)
42036 FA27
..c -/-rwxrwxrwx 0
37888..c -/-rwxrwxrwx 0
Tue Jun 17 2004 17:09:22

Fri Jun 18 2004 16:09:26

357..c -/-rwxrwxrwx 0
4096 m.. d/drwxrwxrwx 0

118882995.a. -/-rwxrwxrwx 0

0rwxrwx 0

1188729 <unknowndcfldd_hdd_sda1_dd: x86 boot sector, code
offset0x58, OEM-ID “MSWIN4.1”, sectors/cluster 8, Media
descriptor 0xf8, heads 255, hidden sectors 63, sectors
12659157 (volumes > 32 MB), FAT (32 bit), sectors/FAT
12342, reserved3 0x800000, serial number 0x1c12160a9df *Camou121. Microsoft 12 Jan 2005 <http://www.microsoft.com/resources/documentation/Windows/XP
/all/reskit/en-us/Default.asp#10531033.aspx>

0
0
0
0
0
0
0
====================
